<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title id="head-title">report.html</title>
      <link href="assets/style.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <h1 id="title">report.html</h1>
    <p>Report generated on 09-Dec-2025 at 21:23:57 by <a href="https://pypi.python.org/pypi/pytest-html">pytest-html</a>
        v4.1.1</p>
    <div id="environment-header">
      <h2>Environment</h2>
    </div>
    <table id="environment"></table>
    <!-- TEMPLATES -->
      <template id="template_environment_row">
      <tr>
        <td></td>
        <td></td>
      </tr>
    </template>
    <template id="template_results-table__body--empty">
      <tbody class="results-table-row">
        <tr id="not-found-message">
          <td colspan="4">No results found. Check the filters.</th>
        </tr>
    </template>
    <template id="template_results-table__tbody">
      <tbody class="results-table-row">
        <tr class="collapsible">
        </tr>
        <tr class="extras-row">
          <td class="extra" colspan="4">
            <div class="extraHTML"></div>
            <div class="media">
              <div class="media-container">
                  <div class="media-container__nav--left"><</div>
                  <div class="media-container__viewport">
                    <img src="" />
                    <video controls>
                      <source src="" type="video/mp4">
                    </video>
                  </div>
                  <div class="media-container__nav--right">></div>
                </div>
                <div class="media__name"></div>
                <div class="media__counter"></div>
            </div>
            <div class="logwrapper">
              <div class="logexpander"></div>
              <div class="log"></div>
            </div>
          </td>
        </tr>
      </tbody>
    </template>
    <!-- END TEMPLATES -->
    <div class="summary">
      <div class="summary__data">
        <h2>Summary</h2>
        <div class="additional-summary prefix">
        </div>
        <p class="run-count">25 tests took 00:00:02.</p>
        <p class="filter">(Un)check the boxes to filter the results.</p>
        <div class="summary__reload">
          <div class="summary__reload__button hidden" onclick="location.reload()">
            <div>There are still tests running. <br />Reload this page to get the latest results!</div>
          </div>
        </div>
        <div class="summary__spacer"></div>
        <div class="controls">
          <div class="filters">
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="failed" />
            <span class="failed">5 Failed,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="passed" />
            <span class="passed">20 Passed,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="skipped" />
            <span class="skipped">2 Skipped,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="xfailed" disabled/>
            <span class="xfailed">0 Expected failures,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="xpassed" disabled/>
            <span class="xpassed">0 Unexpected passes,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="error" disabled/>
            <span class="error">0 Errors,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="rerun" disabled/>
            <span class="rerun">0 Reruns</span>
          </div>
          <div class="collapse">
            <button id="show_all_details">Show all details</button>&nbsp;/&nbsp;<button id="hide_all_details">Hide all details</button>
          </div>
        </div>
      </div>
      <div class="additional-summary summary">
      </div>
      <div class="additional-summary postfix">
      </div>
    </div>
    <table id="results-table">
      <thead id="results-table-head">
        <tr>
          <th class="sortable" data-column-type="result">Result</th>
          <th class="sortable" data-column-type="testId">Test</th>
          <th class="sortable" data-column-type="duration">Duration</th>
          <th>Links</th>
        </tr>
      </thead>
    </table>
  </body>
  <footer>
    <div id="data-container" data-jsonblob="{&#34;environment&#34;: {&#34;Python&#34;: &#34;3.12.3&#34;, &#34;Platform&#34;: &#34;Linux-6.14.0-36-generic-x86_64-with-glibc2.39&#34;, &#34;Packages&#34;: {&#34;pytest&#34;: &#34;9.0.2&#34;, &#34;pluggy&#34;: &#34;1.6.0&#34;}, &#34;Plugins&#34;: {&#34;html&#34;: &#34;4.1.1&#34;, &#34;cov&#34;: &#34;7.0.0&#34;, &#34;metadata&#34;: &#34;3.1.1&#34;}}, &#34;tests&#34;: {&#34;tests/test_conditioning.py::test_film_shape_consistency&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_film_shape_consistency&#34;, &#34;duration&#34;: &#34;2 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_film_shape_consistency&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;2 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;tests/test_conditioning.py::test_film_modulation&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_film_modulation&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_film_modulation&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;tests/test_conditioning.py::test_film_spatial_broadcasting&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_film_spatial_broadcasting&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_film_spatial_broadcasting&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;tests/test_conditioning.py::test_film_conditioning_effect&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_film_conditioning_effect&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_film_conditioning_effect&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;tests/test_conditioning.py::test_conditioner_output_shape&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_conditioner_output_shape&#34;, &#34;duration&#34;: &#34;6 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_conditioner_output_shape&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;6 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;tests/test_conditioning.py::test_conditioner_spec_compliant_mode&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_conditioner_spec_compliant_mode&#34;, &#34;duration&#34;: &#34;2 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_conditioner_spec_compliant_mode&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;2 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;tests/test_conditioning.py::test_conditioner_spatial_mode&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_conditioner_spatial_mode&#34;, &#34;duration&#34;: &#34;3 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_conditioner_spatial_mode&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;3 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;tests/test_conditioning.py::test_conditioner_batch_processing&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_conditioner_batch_processing&#34;, &#34;duration&#34;: &#34;4 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_conditioner_batch_processing&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;4 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;tests/test_conditioning.py::test_conditioner_determinism&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_conditioner_determinism&#34;, &#34;duration&#34;: &#34;4 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_conditioner_determinism&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;4 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;tests/test_conditioning.py::test_coupling_invertibility&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_coupling_invertibility&#34;, &#34;duration&#34;: &#34;6 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_coupling_invertibility&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;6 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nh norm: 11.719818115234375\ngamma range: [-0.9749946594238281, 0.7450891137123108]\nbeta range: [-0.8120477795600891, 1.1055997610092163]\nfeature norm before: 14.221125602722168\nfeature norm after: 9.684901237487793\nh norm: 11.719818115234375\ngamma range: [-0.969092071056366, 0.81006920337677]\nbeta range: [-0.8937160968780518, 0.7859985828399658]\nfeature norm before: 4.1639580726623535\nfeature norm after: 7.9219160079956055\nh norm: 11.719818115234375\ngamma range: [-0.9749946594238281, 0.7450891137123108]\nbeta range: [-0.8120477795600891, 1.1055997610092163]\nfeature norm before: 14.842456817626953\nfeature norm after: 9.706282615661621\nh norm: 11.719818115234375\ngamma range: [-0.969092071056366, 0.81006920337677]\nbeta range: [-0.8937160968780518, 0.7859985828399658]\nfeature norm before: 4.0040435791015625\nfeature norm after: 7.916766166687012\nh norm: 11.719818115234375\ngamma range: [-0.9749946594238281, 0.7450891137123108]\nbeta range: [-0.8120477795600891, 1.1055997610092163]\nfeature norm before: 14.221125602722168\nfeature norm after: 9.684901237487793\nh norm: 11.719818115234375\ngamma range: [-0.969092071056366, 0.81006920337677]\nbeta range: [-0.8937160968780518, 0.7859985828399658]\nfeature norm before: 4.1639580726623535\nfeature norm after: 7.9219160079956055\nh norm: 11.719818115234375\ngamma range: [-0.9749946594238281, 0.7450891137123108]\nbeta range: [-0.8120477795600891, 1.1055997610092163]\nfeature norm before: 14.842456817626953\nfeature norm after: 9.706282615661621\nh norm: 11.719818115234375\ngamma range: [-0.969092071056366, 0.81006920337677]\nbeta range: [-0.8937160968780518, 0.7859985828399658]\nfeature norm before: 4.0040435791015625\nfeature norm after: 7.916766166687012\n&#34;}], &#34;tests/test_conditioning.py::test_coupling_log_det_numerical&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_coupling_log_det_numerical&#34;, &#34;duration&#34;: &#34;16 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_coupling_log_det_numerical&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;16 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;@pytest.mark.critical\n    def test_coupling_log_det_numerical():\n        &amp;quot;&amp;quot;&amp;quot;\n        CRITICAL: Compare analytical vs numerical Jacobian\n        This test validates that the analytical log-determinant computation\n        matches a numerical finite-difference Jacobian calculation.\n        &amp;quot;&amp;quot;&amp;quot;\n        logger.info(&amp;quot;Testing coupling log-det numerical validation...&amp;quot;)\n        logger.info(&amp;quot;  [CRITICAL TEST - NO PASS STATEMENT]&amp;quot;)\n    \n        # Use smaller dimensions for tractable Jacobian computation\n        layer = ConditionalAffineCoupling(\n            dim=10,\n            split_dim=5,\n            h_dim=8,\n            hidden_dims=[32, 32],\n            use_batch_norm=False,  # Simpler for numerical test\n            s_max=2.0\n        )\n        layer.eval()\n    \n        x = torch.randn(2, 10, requires_grad=False)\n        h = torch.randn(2, 8, requires_grad=False)\n    \n        # Analytical log-det from layer\n        z, log_det_analytical = layer.forward(x, h, reverse=False)\n    \n        logger.info(f&amp;quot;  Computing numerical Jacobian (10x10)...&amp;quot;)\n    \n        # Define forward function for Jacobian\n        def forward_func(x_input):\n            with torch.no_grad():\n                z_out, _ = layer.forward(x_input, h, reverse=False)\n            return z_out\n    \n        # Compute numerical Jacobian via finite differences\n        jacobian = compute_numerical_jacobian(forward_func, x, h, eps=1e-4)\n    \n        # Compute log-det from Jacobian\n        log_det_numerical = compute_log_det_from_jacobian(jacobian)\n    \n        # Compare\n        error = torch.abs(log_det_analytical - log_det_numerical)\n        max_error = torch.max(error).item()\n        mean_error = torch.mean(error).item()\n    \n        logger.info(f&amp;quot;  Analytical log-det: {log_det_analytical.detach().numpy()}&amp;quot;)\n        logger.info(f&amp;quot;  Numerical log-det:  {log_det_numerical.detach().numpy()}&amp;quot;)\n        logger.info(f&amp;quot;  Max error: {max_error:.6f}&amp;quot;)\n        logger.info(f&amp;quot;  Mean error: {mean_error:.6f}&amp;quot;)\n    \n        try:\n&amp;gt;           assert max_error &amp;lt; 1e-3, \\\n                f&amp;quot;Log-det mismatch: max_error={max_error:.6f} &amp;gt;= 1e-3&amp;quot;\nE               AssertionError: Log-det mismatch: max_error=0.001556 &amp;gt;= 1e-3\nE               assert 0.0015555918216705322 &amp;lt; 0.001\n\ntests/test_conditioning.py:530: AssertionError\n\n----------------------------- Captured stdout call -----------------------------\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.060678958892822\nfeature norm after: 2.3197569847106934\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.250980019569397\nfeature norm after: 1.5147976875305176\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.925358295440674\nfeature norm after: 2.321908473968506\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.1743711233139038\nfeature norm after: 1.5137693881988525\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.060657024383545\nfeature norm after: 2.319767713546753\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.2509851455688477\nfeature norm after: 1.5147972106933594\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.925397872924805\nfeature norm after: 2.3219268321990967\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.1743757724761963\nfeature norm after: 1.5137691497802734\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.060700416564941\nfeature norm after: 2.319746255874634\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.2509751319885254\nfeature norm after: 1.5147981643676758\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.925318717956543\nfeature norm after: 2.321890354156494\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.1743667125701904\nfeature norm after: 1.5137696266174316\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.060667991638184\nfeature norm after: 2.319756269454956\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.2509795427322388\nfeature norm after: 1.5147980451583862\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.9253411293029785\nfeature norm after: 2.321897029876709\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.174360752105713\nfeature norm after: 1.513769507408142\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.060689449310303\nfeature norm after: 2.3197576999664307\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.2509806156158447\nfeature norm after: 1.5147974491119385\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.925374984741211\nfeature norm after: 2.3219199180603027\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.1743814945220947\nfeature norm after: 1.513769268989563\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.060614585876465\nfeature norm after: 2.3197379112243652\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.2509708404541016\nfeature norm after: 1.5147974491119385\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.925314426422119\nfeature norm after: 2.321910858154297\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.1743707656860352\nfeature norm after: 1.5137693881988525\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.0607428550720215\nfeature norm after: 2.3197762966156006\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.2509891986846924\nfeature norm after: 1.5147980451583862\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.9254021644592285\nfeature norm after: 2.321906328201294\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.1743714809417725\nfeature norm after: 1.5137693881988525\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.060770511627197\nfeature norm after: 2.3197743892669678\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.2509905099868774\nfeature norm after: 1.514798641204834\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.925420761108398\nfeature norm after: 2.3219258785247803\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.1743803024291992\nfeature norm after: 1.5137699842453003\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.060586929321289\nfeature norm after: 2.319739580154419\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.2509695291519165\nfeature norm after: 1.5147968530654907\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.925295829772949\nfeature norm after: 2.3218910694122314\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.174362063407898\nfeature norm after: 1.5137686729431152\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.06075382232666\nfeature norm after: 2.319766044616699\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.250983476638794\nfeature norm after: 1.5147994756698608\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.925457954406738\nfeature norm after: 2.3219311237335205\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.1743781566619873\nfeature norm after: 1.5137690305709839\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.060603618621826\nfeature norm after: 2.3197479248046875\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.2509765625\nfeature norm after: 1.5147960186004639\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.925258636474609\nfeature norm after: 2.321885824203491\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.1743642091751099\nfeature norm after: 1.5137696266174316\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.060678958892822\nfeature norm after: 2.3197569847106934\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.250980019569397\nfeature norm after: 1.5147976875305176\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.925358295440674\nfeature norm after: 2.321908473968506\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.1743711233139038\nfeature norm after: 1.5137693881988525\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.060678958892822\nfeature norm after: 2.3197569847106934\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.250980019569397\nfeature norm after: 1.5147976875305176\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.925358295440674\nfeature norm after: 2.321908473968506\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.1743711233139038\nfeature norm after: 1.5137693881988525\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.060678958892822\nfeature norm after: 2.3197569847106934\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.250980019569397\nfeature norm after: 1.5147976875305176\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.925358295440674\nfeature norm after: 2.321908473968506\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.1743711233139038\nfeature norm after: 1.5137693881988525\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.060678958892822\nfeature norm after: 2.3197569847106934\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.250980019569397\nfeature norm after: 1.5147976875305176\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.925358295440674\nfeature norm after: 2.321908473968506\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.1743711233139038\nfeature norm after: 1.5137693881988525\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.060678958892822\nfeature norm after: 2.3197569847106934\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.250980019569397\nfeature norm after: 1.5147976875305176\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.925358295440674\nfeature norm after: 2.321908473968506\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.1743711233139038\nfeature norm after: 1.5137693881988525\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.060678958892822\nfeature norm after: 2.3197569847106934\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.250980019569397\nfeature norm after: 1.5147976875305176\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.925358295440674\nfeature norm after: 2.321908473968506\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.1743711233139038\nfeature norm after: 1.5137693881988525\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.060678958892822\nfeature norm after: 2.3197569847106934\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.250980019569397\nfeature norm after: 1.5147976875305176\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.925358295440674\nfeature norm after: 2.321908473968506\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.1743711233139038\nfeature norm after: 1.5137693881988525\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.060678958892822\nfeature norm after: 2.3197569847106934\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.250980019569397\nfeature norm after: 1.5147976875305176\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.925358295440674\nfeature norm after: 2.321908473968506\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.1743711233139038\nfeature norm after: 1.5137693881988525\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.060678958892822\nfeature norm after: 2.3197569847106934\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.250980019569397\nfeature norm after: 1.5147976875305176\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.925358295440674\nfeature norm after: 2.321908473968506\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.1743711233139038\nfeature norm after: 1.5137693881988525\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 5.060678958892822\nfeature norm after: 2.3197569847106934\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.250980019569397\nfeature norm after: 1.5147976875305176\nh norm: 2.4418540000915527\ngamma range: [-0.5827749967575073, 0.7042169570922852]\nbeta range: [-0.45997384190559387, 0.5203334093093872]\nfeature norm before: 4.925358295440674\nfeature norm after: 2.321908473968506\nh norm: 2.4418540000915527\ngamma range: [-0.5415931940078735, 0.6725736260414124]\nbeta range: [-0.48714902997016907, 0.5478456616401672]\nfeature norm before: 1.1743711233139038\nfeature norm after: 1.5137693881988525\n\n------------------------------ Captured log call -------------------------------\nERROR    tests.test_conditioning:test_conditioning.py:534   \u2717 Numerical Jacobian test FAILED!\nERROR    tests.test_conditioning:test_conditioning.py:535     Tolerance: 1e-3\nERROR    tests.test_conditioning:test_conditioning.py:536     Max error: 0.001556\nERROR    tests.test_conditioning:test_conditioning.py:537     Analytical: [-0.4466451108455658, -0.2354411780834198]\nERROR    tests.test_conditioning:test_conditioning.py:538     Numerical: [-0.44585978984832764, -0.23699676990509033]\n\n&#34;}], &#34;tests/test_conditioning.py::test_coupling_conditioning&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_coupling_conditioning&#34;, &#34;duration&#34;: &#34;3 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_coupling_conditioning&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;3 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nh norm: 7.567995548248291\ngamma range: [-0.6710789203643799, 0.7066663503646851]\nbeta range: [-0.5956451296806335, 0.5750294923782349]\nfeature norm before: 9.279376029968262\nfeature norm after: 4.918078422546387\nh norm: 7.567995548248291\ngamma range: [-0.6767616271972656, 0.7684674859046936]\nbeta range: [-0.8292888402938843, 0.6984622478485107]\nfeature norm before: 2.286492347717285\nfeature norm after: 5.332687854766846\nh norm: 7.567995548248291\ngamma range: [-0.6710789203643799, 0.7066663503646851]\nbeta range: [-0.5956451296806335, 0.5750294923782349]\nfeature norm before: 9.693050384521484\nfeature norm after: 5.130886554718018\nh norm: 7.567995548248291\ngamma range: [-0.6767616271972656, 0.7684674859046936]\nbeta range: [-0.8292888402938843, 0.6984622478485107]\nfeature norm before: 2.263300895690918\nfeature norm after: 5.349316596984863\nh norm: 8.041719436645508\ngamma range: [-0.8485811352729797, 0.7757171988487244]\nbeta range: [-0.80451899766922, 0.9707061648368835]\nfeature norm before: 9.279376029968262\nfeature norm after: 6.040062427520752\nh norm: 8.041719436645508\ngamma range: [-0.8359643816947937, 0.9097853899002075]\nbeta range: [-0.6740620136260986, 0.7126991748809814]\nfeature norm before: 2.8723409175872803\nfeature norm after: 5.195040225982666\nh norm: 8.041719436645508\ngamma range: [-0.8485811352729797, 0.7757171988487244]\nbeta range: [-0.80451899766922, 0.9707061648368835]\nfeature norm before: 9.693050384521484\nfeature norm after: 5.904477596282959\nh norm: 8.041719436645508\ngamma range: [-0.8359643816947937, 0.9097853899002075]\nbeta range: [-0.6740620136260986, 0.7126991748809814]\nfeature norm before: 2.7016496658325195\nfeature norm after: 5.21931266784668\n&#34;}], &#34;tests/test_conditioning.py::test_coupling_batch_norm&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_coupling_batch_norm&#34;, &#34;duration&#34;: &#34;4 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_coupling_batch_norm&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;4 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nh norm: 11.19123363494873\ngamma range: [-0.7525003552436829, 0.8001790046691895]\nbeta range: [-0.805399477481842, 0.8243672847747803]\nfeature norm before: 14.343194007873535\nfeature norm after: 7.729890823364258\nh norm: 11.19123363494873\ngamma range: [-0.7520748376846313, 0.7389963865280151]\nbeta range: [-0.8773077726364136, 0.9280508160591125]\nfeature norm before: 3.3145487308502197\nfeature norm after: 7.786847114562988\nh norm: 11.19123363494873\ngamma range: [-0.7525003552436829, 0.8001790046691895]\nbeta range: [-0.805399477481842, 0.8243672847747803]\nfeature norm before: 13.522974014282227\nfeature norm after: 7.846748352050781\nh norm: 11.19123363494873\ngamma range: [-0.7520748376846313, 0.7389963865280151]\nbeta range: [-0.8773077726364136, 0.9280508160591125]\nfeature norm before: 3.2816827297210693\nfeature norm after: 7.788371562957764\nh norm: 11.19123363494873\ngamma range: [-0.6922249794006348, 0.8914824724197388]\nbeta range: [-1.0546048879623413, 1.0963115692138672]\nfeature norm before: 11.978800773620605\nfeature norm after: 8.391717910766602\nh norm: 11.19123363494873\ngamma range: [-0.6260768175125122, 0.8885181546211243]\nbeta range: [-0.7257485389709473, 0.7322311401367188]\nfeature norm before: 3.3497931957244873\nfeature norm after: 8.23724365234375\nh norm: 11.19123363494873\ngamma range: [-0.6922249794006348, 0.8914824724197388]\nbeta range: [-1.0546048879623413, 1.0963115692138672]\nfeature norm before: 13.028388023376465\nfeature norm after: 8.57394790649414\nh norm: 11.19123363494873\ngamma range: [-0.6260768175125122, 0.8885181546211243]\nbeta range: [-0.7257485389709473, 0.7322311401367188]\nfeature norm before: 3.6604456901550293\nfeature norm after: 8.266475677490234\n&#34;}], &#34;tests/test_conditioning.py::test_coupling_masking&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_coupling_masking&#34;, &#34;duration&#34;: &#34;3 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_coupling_masking&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;3 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;def test_coupling_masking():\n        &amp;quot;&amp;quot;&amp;quot;Test checkerboard and channel masks&amp;quot;&amp;quot;&amp;quot;\n        logger.info(&amp;quot;Testing coupling layer masking...&amp;quot;)\n    \n        # Test checkerboard mask\n        mask_checker = checkerboard_mask(4, 4)\n        logger.info(f&amp;quot;  Checkerboard mask shape: {mask_checker.shape}&amp;quot;)\n        logger.info(f&amp;quot;  Checkerboard pattern:\\n{mask_checker.view(4, 4).int()}&amp;quot;)\n    \n        layer_checker = ConditionalAffineCoupling(\n            dim=16,  # 4x4 flattened\n            split_dim=8,\n            h_dim=16,\n            hidden_dims=[32],\n            mask=mask_checker\n        )\n    \n        x = torch.randn(4, 16)\n        h = torch.randn(4, 16)\n    \n        z, log_det = layer_checker.forward(x, h, reverse=False)\n        x_recon, _ = layer_checker.forward(z, h, reverse=True)\n    \n        error_checker = torch.max(torch.abs(x - x_recon)).item()\n&amp;gt;       assert error_checker &amp;lt; 1e-5, f&amp;quot;Checkerboard mask invertibility failed: {error_checker}&amp;quot;\nE       AssertionError: Checkerboard mask invertibility failed: 0.7409380078315735\nE       assert 0.7409380078315735 &amp;lt; 1e-05\n\ntests/test_conditioning.py:661: AssertionError\n\n----------------------------- Captured stdout call -----------------------------\nh norm: 7.665194988250732\ngamma range: [-0.9201555252075195, 0.37547069787979126]\nbeta range: [-0.6081191301345825, 0.6201663017272949]\nfeature norm before: 4.751547336578369\nfeature norm after: 3.13073992729187\nh norm: 7.665194988250732\ngamma range: [-0.9201555252075195, 0.37547069787979126]\nbeta range: [-0.6081191301345825, 0.6201663017272949]\nfeature norm before: 4.850203990936279\nfeature norm after: 3.23186993598938\nh norm: 7.665194988250732\ngamma range: [-0.9201555252075195, 0.37547069787979126]\nbeta range: [-0.6081191301345825, 0.6201663017272949]\nfeature norm before: 5.115795612335205\nfeature norm after: 3.078087091445923\nh norm: 7.665194988250732\ngamma range: [-0.9201555252075195, 0.37547069787979126]\nbeta range: [-0.6081191301345825, 0.6201663017272949]\nfeature norm before: 5.262425899505615\nfeature norm after: 3.109041929244995\n&#34;}], &#34;tests/test_conditioning.py::test_coupling_stability&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_coupling_stability&#34;, &#34;duration&#34;: &#34;2 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_coupling_stability&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;2 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nh norm: 74.64630889892578\ngamma range: [-8.411388397216797, 6.6920037269592285]\nbeta range: [-5.937978744506836, 6.817840099334717]\nfeature norm before: 9.45556926727295\nfeature norm after: 53.19229507446289\nh norm: 74.64630889892578\ngamma range: [-8.036848068237305, 9.598103523254395]\nbeta range: [-8.686503410339355, 8.31864070892334]\nfeature norm before: 22.279451370239258\nfeature norm after: 79.77625274658203\nh norm: 74.64630889892578\ngamma range: [-8.411388397216797, 6.6920037269592285]\nbeta range: [-5.937978744506836, 6.817840099334717]\nfeature norm before: 8.685770034790039\nfeature norm after: 51.32485580444336\nh norm: 74.64630889892578\ngamma range: [-8.036848068237305, 9.598103523254395]\nbeta range: [-8.686503410339355, 8.31864070892334]\nfeature norm before: 20.606279373168945\nfeature norm after: 71.64775848388672\n&#34;}], &#34;tests/test_conditioning.py::test_realnvp_invertibility&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_realnvp_invertibility&#34;, &#34;duration&#34;: &#34;35 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_realnvp_invertibility&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;35 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = ConditionalRealNVP(\n  (conditioner): MNISTConditioner(\n    (encoder): Sequential(\n      (0): Conv2d(1, 32, kernel_size...      (2): Linear(in_features=256, out_features=256, bias=True)\n            )\n          )\n        )\n      )\n    )\n  )\n)\nz = tensor([[[[ 1.0000, -1.0000, -1.0000,  1.0000,  1.0000, -1.0000,  1.0000],\n          [-1.0000,  1.0000,  1.0000, -1.00...-1.0879],\n          [-1.0530,  0.7858, -1.0924, -1.0738,  0.8814,  1.0405,  0.9015]]]],\n       grad_fn=&amp;lt;ViewBackward0&amp;gt;)\nz_factored_list = [tensor([[[[ 1.0000,  1.0000, -1.0000,  1.0000, -1.0000, -1.0000, -1.0000,\n            1.0000, -1.0000,  1.0000, -1.00....1219],\n          [-1.2350, -0.9628, -0.9633,  0.8743, -1.0391,  1.0802, -0.7639]]]],\n       grad_fn=&amp;lt;SliceBackward0&amp;gt;)]\ny = tensor([[[[ 1.7966e-01, -9.8297e-01, -2.6193e-01,  ...,  4.5766e-01,\n           -1.4262e+00, -7.9805e-01],\n          [...239e+00],\n          [ 8.0171e-03, -5.5391e-01,  1.2098e+00,  ...,  8.7603e-01,\n           -2.8084e-01, -2.9075e-01]]]])\n\n    def inverse(\n        self,\n        z: torch.Tensor,\n        z_factored_list: List[torch.Tensor],\n        y: torch.Tensor\n    ) -&amp;gt; torch.Tensor:\n        &amp;quot;&amp;quot;&amp;quot;\n        Inverse transform: z \u2192 x (sampling/reconstruction).\n    \n        Args:\n            z: Final latent code [B, 4, 7, 7]\n            z_factored_list: List of factored variables [z_factor2, z_factor1]\n            y: Degraded observation [B, 1, 28, 28]\n    \n        Returns:\n            x: Reconstructed data [B, 1, 28, 28]\n    \n        Raises:\n            ValueError: If input shapes are invalid\n            RuntimeError: If inverse pass fails\n        &amp;quot;&amp;quot;&amp;quot;\n        # Input validation\n        if z.ndim != 4:\n            raise ValueError(f&amp;quot;z must be 4D [batch, C, H, W], got shape {z.shape}&amp;quot;)\n        if y.ndim != 4:\n            raise ValueError(f&amp;quot;y must be 4D [batch, C, H, W], got shape {y.shape}&amp;quot;)\n        if z.shape[0] != y.shape[0]:\n            raise ValueError(f&amp;quot;Batch size mismatch: z={z.shape[0]}, y={y.shape[0]}&amp;quot;)\n        if len(z_factored_list) != 2:\n            raise ValueError(f&amp;quot;Expected 2 factored variables, got {len(z_factored_list)}&amp;quot;)\n    \n        logger.debug(f&amp;quot;Inverse: z.shape={z.shape}, y.shape={y.shape}&amp;quot;)\n    \n        # Extract conditioning features\n        h = self.conditioner(y)\n        logger.debug(&amp;quot;Extracted h for inverse pass&amp;quot;)\n    \n        try:\n            # Start from final latent\n            x = z.clone()\n    \n            # Scale 3 inverse: [B,4,7,7] \u2192 3 coupling \u2192 [B,4,7,7]\n&amp;gt;           x, _ = self.scale3.forward(x, h, reverse=True)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\ncsmf/flows/conditional_realnvp.py:515: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = ScaleBlock(\n  (coupling_layers): ModuleList(\n    (0-2): 3 x ConditionalAffineCoupling(\n      (batch_norm): BatchNorm1d... ReLU()\n            (2): Linear(in_features=256, out_features=256, bias=True)\n          )\n        )\n      )\n    )\n  )\n)\nz = tensor([[[[ 1.0000, -1.0000, -1.0000,  1.0000,  1.0000, -1.0000,  1.0000],\n          [-1.0000,  1.0000,  1.0000, -1.00...1.0879],\n          [-1.0530,  0.7858, -1.0924, -1.0738,  0.8814,  1.0405,  0.9015]]]],\n       grad_fn=&amp;lt;CloneBackward0&amp;gt;)\nh = tensor([[[[0.0000, 0.2332, 0.1933,  ..., 0.3244, 0.2311, 0.0000],\n          [0.0882, 0.2624, 0.0000,  ..., 0.0000, 0.1..., 0.0000, 0.0000],\n          [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]]],\n       grad_fn=&amp;lt;ReluBackward0&amp;gt;)\nreverse = True\n\n    def forward(\n        self,\n        z: torch.Tensor,\n        h: torch.Tensor,\n        reverse: bool = False\n    ) -&amp;gt; Tuple[torch.Tensor, torch.Tensor]:\n        &amp;quot;&amp;quot;&amp;quot;\n        Forward through coupling layers, with optional squeeze.\n    \n        Args:\n            z: Input [B, C, H, W]\n            h: Conditioning features [B, h_dim] or [B, h_dim, H&amp;#x27;, W&amp;#x27;]\n            reverse: If True, run in inverse direction\n    \n        Returns:\n            z_out: Output (squeezed if apply_squeeze=True)\n            log_det: Log-determinant [B]\n        &amp;quot;&amp;quot;&amp;quot;\n        B, C, H, W = z.shape\n        log_det = torch.zeros(B, device=z.device)\n    \n        # Flatten for coupling layers\n        z_flat = z.reshape(B, -1)\n    \n        &amp;#x27;&amp;#x27;&amp;#x27;\n        if not reverse:\n            # Forward: apply coupling layers then squeeze\n            for i, layer in enumerate(self.coupling_layers):\n                z_flat, ld = layer.forward(z_flat, h, reverse=False)\n                log_det = log_det + ld\n    \n            # Reshape back to spatial\n            z_out = z_flat.reshape(B, C, H, W)\n    \n            # Apply squeeze if configured\n            if self.apply_squeeze:\n                z_out = self._squeeze(z_out)\n                # Squeeze is volume-preserving (no log-det change)\n        else:\n            # Inverse: unsqueeze first (if needed), then apply coupling layers in reverse\n            z_out = z_flat.reshape(B, C, H, W)\n    \n            if self.apply_squeeze:\n                z_out = self._unsqueeze(z_out)\n    \n            z_flat = z_out.reshape(B, -1)\n    \n            # Apply coupling layers in reverse order\n            for i, layer in enumerate(reversed(self.coupling_layers)):\n                z_flat, ld = layer.forward(z_flat, h, reverse=True)\n                log_det = log_det + ld\n    \n            z_out = z_flat.reshape(B, C, H, W)\n        &amp;#x27;&amp;#x27;&amp;#x27;\n    \n    \n        ############## ERROR 3: test_realnvp_invertibility ######################\n        if not reverse:\n            # Forward: coupling \u2192 squeeze\n            for coupling in self.coupling_layers:\n                z_flat, ld = coupling.forward(z_flat, h, reverse=False)\n            z_out = z_flat.reshape(B, C, H, W)\n            if self.apply_squeeze:\n                z_out = self._squeeze(z_out)\n        else:\n            # Inverse: unsqueeze FIRST \u2192 coupling\n            z_out = z_flat.reshape(B, C, H, W)\n            if self.apply_squeeze:\n                z_out = self._unsqueeze(z_out)  # Expand spatial dims FIRST\n    \n            z_flat = z_out.reshape(B, -1)  # Re-flatten for coupling\n            for coupling in reversed(self.coupling_layers):\n                z_flat, ld = coupling.forward(z_flat, h, reverse=True)\n&amp;gt;           z_out = z_flat.reshape(B, C*4, H*2, W*2)  # or appropriate shape\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE           RuntimeError: shape &amp;#x27;[2, 16, 14, 14]&amp;#x27; is invalid for input of size 392\n\ncsmf/flows/conditional_realnvp.py:159: RuntimeError\n\nDuring handling of the above exception, another exception occurred:\n\n    def test_realnvp_invertibility():\n        &amp;quot;&amp;quot;&amp;quot;Test multi-scale RealNVP invertibility&amp;quot;&amp;quot;&amp;quot;\n        logger.info(&amp;quot;Testing RealNVP multi-scale invertibility...&amp;quot;)\n    \n        model = ConditionalRealNVP(h_dim=64, hidden_dims=[256, 256])\n    \n        x = torch.randn(2, 1, 28, 28)\n        y = torch.randn(2, 1, 28, 28)\n    \n        # Forward\n        z_final, z_factored_list, log_det, log_prob = model.forward(x, y)\n    \n        logger.info(f&amp;quot;  Forward shapes:&amp;quot;)\n        logger.info(f&amp;quot;    z_final: {z_final.shape}&amp;quot;)\n        logger.info(f&amp;quot;    z_factored: {[z.shape for z in z_factored_list]}&amp;quot;)\n    \n        # Inverse\n&amp;gt;       x_recon = model.inverse(z_final, z_factored_list, y)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\ntests/test_conditioning.py:745: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = ConditionalRealNVP(\n  (conditioner): MNISTConditioner(\n    (encoder): Sequential(\n      (0): Conv2d(1, 32, kernel_size...      (2): Linear(in_features=256, out_features=256, bias=True)\n            )\n          )\n        )\n      )\n    )\n  )\n)\nz = tensor([[[[ 1.0000, -1.0000, -1.0000,  1.0000,  1.0000, -1.0000,  1.0000],\n          [-1.0000,  1.0000,  1.0000, -1.00...-1.0879],\n          [-1.0530,  0.7858, -1.0924, -1.0738,  0.8814,  1.0405,  0.9015]]]],\n       grad_fn=&amp;lt;ViewBackward0&amp;gt;)\nz_factored_list = [tensor([[[[ 1.0000,  1.0000, -1.0000,  1.0000, -1.0000, -1.0000, -1.0000,\n            1.0000, -1.0000,  1.0000, -1.00....1219],\n          [-1.2350, -0.9628, -0.9633,  0.8743, -1.0391,  1.0802, -0.7639]]]],\n       grad_fn=&amp;lt;SliceBackward0&amp;gt;)]\ny = tensor([[[[ 1.7966e-01, -9.8297e-01, -2.6193e-01,  ...,  4.5766e-01,\n           -1.4262e+00, -7.9805e-01],\n          [...239e+00],\n          [ 8.0171e-03, -5.5391e-01,  1.2098e+00,  ...,  8.7603e-01,\n           -2.8084e-01, -2.9075e-01]]]])\n\n    def inverse(\n        self,\n        z: torch.Tensor,\n        z_factored_list: List[torch.Tensor],\n        y: torch.Tensor\n    ) -&amp;gt; torch.Tensor:\n        &amp;quot;&amp;quot;&amp;quot;\n        Inverse transform: z \u2192 x (sampling/reconstruction).\n    \n        Args:\n            z: Final latent code [B, 4, 7, 7]\n            z_factored_list: List of factored variables [z_factor2, z_factor1]\n            y: Degraded observation [B, 1, 28, 28]\n    \n        Returns:\n            x: Reconstructed data [B, 1, 28, 28]\n    \n        Raises:\n            ValueError: If input shapes are invalid\n            RuntimeError: If inverse pass fails\n        &amp;quot;&amp;quot;&amp;quot;\n        # Input validation\n        if z.ndim != 4:\n            raise ValueError(f&amp;quot;z must be 4D [batch, C, H, W], got shape {z.shape}&amp;quot;)\n        if y.ndim != 4:\n            raise ValueError(f&amp;quot;y must be 4D [batch, C, H, W], got shape {y.shape}&amp;quot;)\n        if z.shape[0] != y.shape[0]:\n            raise ValueError(f&amp;quot;Batch size mismatch: z={z.shape[0]}, y={y.shape[0]}&amp;quot;)\n        if len(z_factored_list) != 2:\n            raise ValueError(f&amp;quot;Expected 2 factored variables, got {len(z_factored_list)}&amp;quot;)\n    \n        logger.debug(f&amp;quot;Inverse: z.shape={z.shape}, y.shape={y.shape}&amp;quot;)\n    \n        # Extract conditioning features\n        h = self.conditioner(y)\n        logger.debug(&amp;quot;Extracted h for inverse pass&amp;quot;)\n    \n        try:\n            # Start from final latent\n            x = z.clone()\n    \n            # Scale 3 inverse: [B,4,7,7] \u2192 3 coupling \u2192 [B,4,7,7]\n            x, _ = self.scale3.forward(x, h, reverse=True)\n            logger.debug(f&amp;quot;Scale 3 inverse: \u2192 {x.shape}&amp;quot;)\n    \n            # Unfactor scale 2: [B,4,7,7] + factored [B,4,7,7] \u2192 [B,8,7,7]\n            z_factor2 = z_factored_list[1]\n            x = self._unfactor(x, z_factor2)\n            logger.debug(f&amp;quot;Unfactored scale 2: {x.shape}&amp;quot;)\n    \n            # Scale 2 inverse: [B,8,7,7] \u2192 unsqueeze \u2192 [B,2,14,14] \u2192 3 coupling\n            x, _ = self.scale2.forward(x, h, reverse=True)\n            logger.debug(f&amp;quot;Scale 2 inverse: \u2192 {x.shape}&amp;quot;)\n    \n            # Unfactor scale 1: [B,2,14,14] + factored [B,2,14,14] \u2192 [B,4,14,14]\n            z_factor1 = z_factored_list[0]\n            x = self._unfactor(x, z_factor1)\n            logger.debug(f&amp;quot;Unfactored scale 1: {x.shape}&amp;quot;)\n    \n            # Scale 1 inverse: [B,4,14,14] \u2192 unsqueeze \u2192 [B,1,28,28] \u2192 3 coupling\n            x, _ = self.scale1.forward(x, h, reverse=True)\n            logger.debug(f&amp;quot;Scale 1 inverse: \u2192 {x.shape}&amp;quot;)\n    \n            # Numerical stability check\n            if torch.any(torch.isnan(x)) or torch.any(torch.isinf(x)):\n                logger.warning(&amp;quot;NaN/Inf in inverse reconstruction, applying clamp&amp;quot;)\n                x = torch.clamp(x, min=-1e6, max=1e6)\n    \n        except Exception as e:\n            logger.error(f&amp;quot;Inverse pass failed: {e}&amp;quot;)\n&amp;gt;           raise RuntimeError(f&amp;quot;Inverse pass failed: {e}&amp;quot;)\nE           RuntimeError: Inverse pass failed: shape &amp;#x27;[2, 16, 14, 14]&amp;#x27; is invalid for input of size 392\n\ncsmf/flows/conditional_realnvp.py:543: RuntimeError\n\n----------------------------- Captured stdout call -----------------------------\nh norm: 1.1271840333938599\ngamma range: [-0.1488020122051239, 0.1764383316040039]\nbeta range: [-0.1357749104499817, 0.1304689347743988]\nfeature norm before: 9.346068382263184\nfeature norm after: 1.1283255815505981\nh norm: 1.1271840333938599\ngamma range: [-0.13969919085502625, 0.12566474080085754]\nbeta range: [-0.13609443604946136, 0.12210456281900406]\nfeature norm before: 0.7751434445381165\nfeature norm after: 1.1447546482086182\nh norm: 1.1271840333938599\ngamma range: [-0.1488020122051239, 0.1764383316040039]\nbeta range: [-0.1357749104499817, 0.1304689347743988]\nfeature norm before: 9.15805435180664\nfeature norm after: 1.1355245113372803\nh norm: 1.1271840333938599\ngamma range: [-0.13969919085502625, 0.12566474080085754]\nbeta range: [-0.13609443604946136, 0.12210456281900406]\nfeature norm before: 0.7842446565628052\nfeature norm after: 1.1415246725082397\nh norm: 1.1271840333938599\ngamma range: [-0.14741966128349304, 0.1504148244857788]\nbeta range: [-0.16564488410949707, 0.1619640290737152]\nfeature norm before: 9.292241096496582\nfeature norm after: 1.34891939163208\nh norm: 1.1271840333938599\ngamma range: [-0.14153942465782166, 0.14593446254730225]\nbeta range: [-0.1294398009777069, 0.14151473343372345]\nfeature norm before: 0.8003476858139038\nfeature norm after: 1.1552284955978394\nh norm: 1.1271840333938599\ngamma range: [-0.14741966128349304, 0.1504148244857788]\nbeta range: [-0.16564488410949707, 0.1619640290737152]\nfeature norm before: 9.528217315673828\nfeature norm after: 1.3682060241699219\nh norm: 1.1271840333938599\ngamma range: [-0.14153942465782166, 0.14593446254730225]\nbeta range: [-0.1294398009777069, 0.14151473343372345]\nfeature norm before: 0.772467851638794\nfeature norm after: 1.1513522863388062\nh norm: 1.1271840333938599\ngamma range: [-0.13451096415519714, 0.12386222183704376]\nbeta range: [-0.14629726111888885, 0.15596990287303925]\nfeature norm before: 8.918225288391113\nfeature norm after: 1.3186393976211548\nh norm: 1.1271840333938599\ngamma range: [-0.11741293966770172, 0.14747914671897888]\nbeta range: [-0.12808868288993835, 0.13630780577659607]\nfeature norm before: 0.7426236271858215\nfeature norm after: 1.137122392654419\nh norm: 1.1271840333938599\ngamma range: [-0.13451096415519714, 0.12386222183704376]\nbeta range: [-0.14629726111888885, 0.15596990287303925]\nfeature norm before: 9.351393699645996\nfeature norm after: 1.3234628438949585\nh norm: 1.1271840333938599\ngamma range: [-0.11741293966770172, 0.14747914671897888]\nbeta range: [-0.12808868288993835, 0.13630780577659607]\nfeature norm before: 0.7467978000640869\nfeature norm after: 1.1429080963134766\nh norm: 1.1271840333938599\ngamma range: [-0.13265886902809143, 0.12423007190227509]\nbeta range: [-0.1436772346496582, 0.1480911672115326]\nfeature norm before: 9.109259605407715\nfeature norm after: 1.361074447631836\nh norm: 1.1271840333938599\ngamma range: [-0.15384185314178467, 0.13104936480522156]\nbeta range: [-0.18162092566490173, 0.18128123879432678]\nfeature norm before: 0.756027102470398\nfeature norm after: 1.2842416763305664\nh norm: 1.1271840333938599\ngamma range: [-0.13265886902809143, 0.12423007190227509]\nbeta range: [-0.1436772346496582, 0.1480911672115326]\nfeature norm before: 8.559954643249512\nfeature norm after: 1.3149341344833374\nh norm: 1.1271840333938599\ngamma range: [-0.15384185314178467, 0.13104936480522156]\nbeta range: [-0.18162092566490173, 0.18128123879432678]\nfeature norm before: 0.7651047706604004\nfeature norm after: 1.2880373001098633\nh norm: 1.1271840333938599\ngamma range: [-0.13474257290363312, 0.14670614898204803]\nbeta range: [-0.13338281214237213, 0.1076250970363617]\nfeature norm before: 8.939629554748535\nfeature norm after: 1.28104567527771\nh norm: 1.1271840333938599\ngamma range: [-0.11286364495754242, 0.13724103569984436]\nbeta range: [-0.14119142293930054, 0.15506181120872498]\nfeature norm before: 0.7260122895240784\nfeature norm after: 1.260643720626831\nh norm: 1.1271840333938599\ngamma range: [-0.13474257290363312, 0.14670614898204803]\nbeta range: [-0.13338281214237213, 0.1076250970363617]\nfeature norm before: 8.949260711669922\nfeature norm after: 1.2839421033859253\nh norm: 1.1271840333938599\ngamma range: [-0.11286364495754242, 0.13724103569984436]\nbeta range: [-0.14119142293930054, 0.15506181120872498]\nfeature norm before: 0.8172084093093872\nfeature norm after: 1.258184790611267\nh norm: 1.1271840333938599\ngamma range: [-0.1457621455192566, 0.1289212554693222]\nbeta range: [-0.14698579907417297, 0.1359608769416809]\nfeature norm before: 10.24191951751709\nfeature norm after: 1.1696484088897705\nh norm: 1.1271840333938599\ngamma range: [-0.1321493536233902, 0.14136680960655212]\nbeta range: [-0.12032061070203781, 0.14657500386238098]\nfeature norm before: 0.7042067646980286\nfeature norm after: 1.2137233018875122\nh norm: 1.1271840333938599\ngamma range: [-0.1457621455192566, 0.1289212554693222]\nbeta range: [-0.14698579907417297, 0.1359608769416809]\nfeature norm before: 8.910818099975586\nfeature norm after: 1.1632821559906006\nh norm: 1.1271840333938599\ngamma range: [-0.1321493536233902, 0.14136680960655212]\nbeta range: [-0.12032061070203781, 0.14657500386238098]\nfeature norm before: 0.7246931791305542\nfeature norm after: 1.2147715091705322\nh norm: 1.1271840333938599\ngamma range: [-0.1492103636264801, 0.13391943275928497]\nbeta range: [-0.15193229913711548, 0.14267587661743164]\nfeature norm before: 9.399930953979492\nfeature norm after: 1.2505009174346924\nh norm: 1.1271840333938599\ngamma range: [-0.16413649916648865, 0.11790334433317184]\nbeta range: [-0.13080286979675293, 0.13760527968406677]\nfeature norm before: 0.7562915682792664\nfeature norm after: 1.1871821880340576\nh norm: 1.1271840333938599\ngamma range: [-0.1492103636264801, 0.13391943275928497]\nbeta range: [-0.15193229913711548, 0.14267587661743164]\nfeature norm before: 9.581388473510742\nfeature norm after: 1.2448108196258545\nh norm: 1.1271840333938599\ngamma range: [-0.16413649916648865, 0.11790334433317184]\nbeta range: [-0.13080286979675293, 0.13760527968406677]\nfeature norm before: 0.8181350231170654\nfeature norm after: 1.1926075220108032\nh norm: 1.1271840333938599\ngamma range: [-0.10987280309200287, 0.14842531085014343]\nbeta range: [-0.14813503623008728, 0.11866062879562378]\nfeature norm before: 9.271748542785645\nfeature norm after: 1.1248470544815063\nh norm: 1.1271840333938599\ngamma range: [-0.16314198076725006, 0.16646218299865723]\nbeta range: [-0.1515500545501709, 0.13614842295646667]\nfeature norm before: 0.7129690647125244\nfeature norm after: 1.1457961797714233\nh norm: 1.1271840333938599\ngamma range: [-0.10987280309200287, 0.14842531085014343]\nbeta range: [-0.14813503623008728, 0.11866062879562378]\nfeature norm before: 8.920353889465332\nfeature norm after: 1.1614577770233154\nh norm: 1.1271840333938599\ngamma range: [-0.16314198076725006, 0.16646218299865723]\nbeta range: [-0.1515500545501709, 0.13614842295646667]\nfeature norm before: 0.7348508238792419\nfeature norm after: 1.1475446224212646\nh norm: 1.1271840333938599\ngamma range: [-0.1364140510559082, 0.13109567761421204]\nbeta range: [-0.14812420308589935, 0.13616934418678284]\nfeature norm before: 8.856282234191895\nfeature norm after: 1.3511947393417358\nh norm: 1.1271840333938599\ngamma range: [-0.14444495737552643, 0.1563059687614441]\nbeta range: [-0.1229795441031456, 0.14287029206752777]\nfeature norm before: 0.8807403445243835\nfeature norm after: 1.1165590286254883\nh norm: 1.1271840333938599\ngamma range: [-0.1364140510559082, 0.13109567761421204]\nbeta range: [-0.14812420308589935, 0.13616934418678284]\nfeature norm before: 9.309240341186523\nfeature norm after: 1.3391658067703247\nh norm: 1.1271840333938599\ngamma range: [-0.14444495737552643, 0.1563059687614441]\nbeta range: [-0.1229795441031456, 0.14287029206752777]\nfeature norm before: 0.6597020626068115\nfeature norm after: 1.1159460544586182\nh norm: 1.1271840333938599\ngamma range: [-0.1364140510559082, 0.13109567761421204]\nbeta range: [-0.14812420308589935, 0.13616934418678284]\nfeature norm before: 12.158478736877441\nfeature norm after: 1.4116730690002441\nh norm: 1.1271840333938599\ngamma range: [-0.14444495737552643, 0.1563059687614441]\nbeta range: [-0.1229795441031456, 0.14287029206752777]\nfeature norm before: 0.8995407223701477\nfeature norm after: 1.1167935132980347\nh norm: 1.1271840333938599\ngamma range: [-0.1364140510559082, 0.13109567761421204]\nbeta range: [-0.14812420308589935, 0.13616934418678284]\nfeature norm before: 12.803598403930664\nfeature norm after: 1.3945955038070679\nh norm: 1.1271840333938599\ngamma range: [-0.14444495737552643, 0.1563059687614441]\nbeta range: [-0.1229795441031456, 0.14287029206752777]\nfeature norm before: 0.6734581589698792\nfeature norm after: 1.115805745124817\nh norm: 1.1271840333938599\ngamma range: [-0.10987280309200287, 0.14842531085014343]\nbeta range: [-0.14813503623008728, 0.11866062879562378]\nfeature norm before: 17.496625900268555\nfeature norm after: 1.30973219871521\nh norm: 1.1271840333938599\ngamma range: [-0.16314198076725006, 0.16646218299865723]\nbeta range: [-0.1515500545501709, 0.13614842295646667]\nfeature norm before: 0.7640359997749329\nfeature norm after: 1.1462349891662598\nh norm: 1.1271840333938599\ngamma range: [-0.10987280309200287, 0.14842531085014343]\nbeta range: [-0.14813503623008728, 0.11866062879562378]\nfeature norm before: 16.80180549621582\nfeature norm after: 1.3994070291519165\nh norm: 1.1271840333938599\ngamma range: [-0.16314198076725006, 0.16646218299865723]\nbeta range: [-0.1515500545501709, 0.13614842295646667]\nfeature norm before: 0.8153123259544373\nfeature norm after: 1.1487616300582886\nh norm: 1.1271840333938599\ngamma range: [-0.1492103636264801, 0.13391943275928497]\nbeta range: [-0.15193229913711548, 0.14267587661743164]\nfeature norm before: 24.483293533325195\nfeature norm after: 1.7460788488388062\nh norm: 1.1271840333938599\ngamma range: [-0.16413649916648865, 0.11790334433317184]\nbeta range: [-0.13080286979675293, 0.13760527968406677]\nfeature norm before: 0.9159607887268066\nfeature norm after: 1.1877747774124146\nh norm: 1.1271840333938599\ngamma range: [-0.1492103636264801, 0.13391943275928497]\nbeta range: [-0.15193229913711548, 0.14267587661743164]\nfeature norm before: 24.977642059326172\nfeature norm after: 1.7158317565917969\nh norm: 1.1271840333938599\ngamma range: [-0.16413649916648865, 0.11790334433317184]\nbeta range: [-0.13080286979675293, 0.13760527968406677]\nfeature norm before: 0.9401161670684814\nfeature norm after: 1.1921619176864624\n\n------------------------------ Captured log call -------------------------------\nERROR    csmf.flows.conditional_realnvp:conditional_realnvp.py:542 Inverse pass failed: shape &amp;#x27;[2, 16, 14, 14]&amp;#x27; is invalid for input of size 392\n\n&#34;}], &#34;tests/test_conditioning.py::test_realnvp_squeeze_ops&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_realnvp_squeeze_ops&#34;, &#34;duration&#34;: &#34;24 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_realnvp_squeeze_ops&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;24 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;tests/test_conditioning.py::test_realnvp_variable_factoring&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_realnvp_variable_factoring&#34;, &#34;duration&#34;: &#34;27 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_realnvp_variable_factoring&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;27 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nh norm: 1.0555404424667358\ngamma range: [-0.12648111581802368, 0.16380345821380615]\nbeta range: [-0.12040115892887115, 0.12517060339450836]\nfeature norm before: 9.659364700317383\nfeature norm after: 1.2743644714355469\nh norm: 1.0555404424667358\ngamma range: [-0.11927683651447296, 0.12711384892463684]\nbeta range: [-0.12179260700941086, 0.14308500289916992]\nfeature norm before: 0.7138124704360962\nfeature norm after: 1.1087812185287476\nh norm: 1.0555404424667358\ngamma range: [-0.12648111581802368, 0.16380345821380615]\nbeta range: [-0.12040115892887115, 0.12517060339450836]\nfeature norm before: 9.549574851989746\nfeature norm after: 1.2630811929702759\nh norm: 1.0555404424667358\ngamma range: [-0.11927683651447296, 0.12711384892463684]\nbeta range: [-0.12179260700941086, 0.14308500289916992]\nfeature norm before: 0.7432174682617188\nfeature norm after: 1.109745740890503\nh norm: 1.0555404424667358\ngamma range: [-0.13645285367965698, 0.10729476809501648]\nbeta range: [-0.14417576789855957, 0.13470876216888428]\nfeature norm before: 9.817778587341309\nfeature norm after: 1.3059955835342407\nh norm: 1.0555404424667358\ngamma range: [-0.1126924380660057, 0.11991043388843536]\nbeta range: [-0.12401771545410156, 0.13555823266506195]\nfeature norm before: 0.746462345123291\nfeature norm after: 1.1877233982086182\nh norm: 1.0555404424667358\ngamma range: [-0.13645285367965698, 0.10729476809501648]\nbeta range: [-0.14417576789855957, 0.13470876216888428]\nfeature norm before: 9.050447463989258\nfeature norm after: 1.2661774158477783\nh norm: 1.0555404424667358\ngamma range: [-0.1126924380660057, 0.11991043388843536]\nbeta range: [-0.12401771545410156, 0.13555823266506195]\nfeature norm before: 0.6123765707015991\nfeature norm after: 1.1893075704574585\nh norm: 1.0555404424667358\ngamma range: [-0.10181955248117447, 0.13340991735458374]\nbeta range: [-0.12963716685771942, 0.11938651651144028]\nfeature norm before: 9.111790657043457\nfeature norm after: 1.3199537992477417\nh norm: 1.0555404424667358\ngamma range: [-0.11450836807489395, 0.13457608222961426]\nbeta range: [-0.1612424999475479, 0.16299432516098022]\nfeature norm before: 0.7746192812919617\nfeature norm after: 1.1646279096603394\nh norm: 1.0555404424667358\ngamma range: [-0.10181955248117447, 0.13340991735458374]\nbeta range: [-0.12963716685771942, 0.11938651651144028]\nfeature norm before: 8.704817771911621\nfeature norm after: 1.3210288286209106\nh norm: 1.0555404424667358\ngamma range: [-0.11450836807489395, 0.13457608222961426]\nbeta range: [-0.1612424999475479, 0.16299432516098022]\nfeature norm before: 0.7654379606246948\nfeature norm after: 1.1682573556900024\nh norm: 1.0555404424667358\ngamma range: [-0.125193253159523, 0.15121805667877197]\nbeta range: [-0.15825024247169495, 0.1596294343471527]\nfeature norm before: 9.301867485046387\nfeature norm after: 1.294019341468811\nh norm: 1.0555404424667358\ngamma range: [-0.161093607544899, 0.14994829893112183]\nbeta range: [-0.14655524492263794, 0.16154539585113525]\nfeature norm before: 0.8093681931495667\nfeature norm after: 1.1798131465911865\nh norm: 1.0555404424667358\ngamma range: [-0.125193253159523, 0.15121805667877197]\nbeta range: [-0.15825024247169495, 0.1596294343471527]\nfeature norm before: 9.469813346862793\nfeature norm after: 1.2773833274841309\nh norm: 1.0555404424667358\ngamma range: [-0.161093607544899, 0.14994829893112183]\nbeta range: [-0.14655524492263794, 0.16154539585113525]\nfeature norm before: 0.7464741468429565\nfeature norm after: 1.183573842048645\nh norm: 1.0555404424667358\ngamma range: [-0.14199376106262207, 0.14015696942806244]\nbeta range: [-0.13125625252723694, 0.12767812609672546]\nfeature norm before: 9.923669815063477\nfeature norm after: 1.214752197265625\nh norm: 1.0555404424667358\ngamma range: [-0.1505439430475235, 0.1306753158569336]\nbeta range: [-0.1479550302028656, 0.13127873837947845]\nfeature norm before: 0.8038880228996277\nfeature norm after: 1.2283896207809448\nh norm: 1.0555404424667358\ngamma range: [-0.14199376106262207, 0.14015696942806244]\nbeta range: [-0.13125625252723694, 0.12767812609672546]\nfeature norm before: 9.977559089660645\nfeature norm after: 1.185362696647644\nh norm: 1.0555404424667358\ngamma range: [-0.1505439430475235, 0.1306753158569336]\nbeta range: [-0.1479550302028656, 0.13127873837947845]\nfeature norm before: 0.7291548848152161\nfeature norm after: 1.228395700454712\nh norm: 1.0555404424667358\ngamma range: [-0.14599670469760895, 0.1747729480266571]\nbeta range: [-0.1292264461517334, 0.1149260401725769]\nfeature norm before: 8.419483184814453\nfeature norm after: 1.2615530490875244\nh norm: 1.0555404424667358\ngamma range: [-0.14402657747268677, 0.15705981850624084]\nbeta range: [-0.12499017268419266, 0.12839412689208984]\nfeature norm before: 0.8342816233634949\nfeature norm after: 1.1335448026657104\nh norm: 1.0555404424667358\ngamma range: [-0.14599670469760895, 0.1747729480266571]\nbeta range: [-0.1292264461517334, 0.1149260401725769]\nfeature norm before: 8.824753761291504\nfeature norm after: 1.3061540126800537\nh norm: 1.0555404424667358\ngamma range: [-0.14402657747268677, 0.15705981850624084]\nbeta range: [-0.12499017268419266, 0.12839412689208984]\nfeature norm before: 0.8316135406494141\nfeature norm after: 1.1313982009887695\nh norm: 1.0555404424667358\ngamma range: [-0.1399674266576767, 0.13841512799263]\nbeta range: [-0.12826290726661682, 0.13874511420726776]\nfeature norm before: 9.087006568908691\nfeature norm after: 1.2903202772140503\nh norm: 1.0555404424667358\ngamma range: [-0.15241822600364685, 0.1664993166923523]\nbeta range: [-0.16349664330482483, 0.12217042595148087]\nfeature norm before: 0.7336626648902893\nfeature norm after: 1.212623953819275\nh norm: 1.0555404424667358\ngamma range: [-0.1399674266576767, 0.13841512799263]\nbeta range: [-0.12826290726661682, 0.13874511420726776]\nfeature norm before: 9.0868501663208\nfeature norm after: 1.2996141910552979\nh norm: 1.0555404424667358\ngamma range: [-0.15241822600364685, 0.1664993166923523]\nbeta range: [-0.16349664330482483, 0.12217042595148087]\nfeature norm before: 0.7739073038101196\nfeature norm after: 1.2142082452774048\nh norm: 1.0555404424667358\ngamma range: [-0.12498918175697327, 0.0989176481962204]\nbeta range: [-0.1264885663986206, 0.16242530941963196]\nfeature norm before: 9.845414161682129\nfeature norm after: 1.2811195850372314\nh norm: 1.0555404424667358\ngamma range: [-0.13960972428321838, 0.1322563886642456]\nbeta range: [-0.15736815333366394, 0.14247193932533264]\nfeature norm before: 0.9104477167129517\nfeature norm after: 1.1728408336639404\nh norm: 1.0555404424667358\ngamma range: [-0.12498918175697327, 0.0989176481962204]\nbeta range: [-0.1264885663986206, 0.16242530941963196]\nfeature norm before: 8.917747497558594\nfeature norm after: 1.2711443901062012\nh norm: 1.0555404424667358\ngamma range: [-0.13960972428321838, 0.1322563886642456]\nbeta range: [-0.15736815333366394, 0.14247193932533264]\nfeature norm before: 0.7302696108818054\nfeature norm after: 1.169386863708496\nh norm: 1.0555404424667358\ngamma range: [-0.14065489172935486, 0.17650403082370758]\nbeta range: [-0.1300400346517563, 0.14289017021656036]\nfeature norm before: 9.756612777709961\nfeature norm after: 1.262333869934082\nh norm: 1.0555404424667358\ngamma range: [-0.10995190590620041, 0.13017328083515167]\nbeta range: [-0.12900319695472717, 0.10915564000606537]\nfeature norm before: 0.689026415348053\nfeature norm after: 1.1744346618652344\nh norm: 1.0555404424667358\ngamma range: [-0.14065489172935486, 0.17650403082370758]\nbeta range: [-0.1300400346517563, 0.14289017021656036]\nfeature norm before: 9.495810508728027\nfeature norm after: 1.261056900024414\nh norm: 1.0555404424667358\ngamma range: [-0.10995190590620041, 0.13017328083515167]\nbeta range: [-0.12900319695472717, 0.10915564000606537]\nfeature norm before: 0.8079184293746948\nfeature norm after: 1.172580361366272\n&#34;}], &#34;tests/test_conditioning.py::test_realnvp_log_prob&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_realnvp_log_prob&#34;, &#34;duration&#34;: &#34;27 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_realnvp_log_prob&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;27 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;def test_realnvp_log_prob():\n        &amp;quot;&amp;quot;&amp;quot;Test log-probability computation&amp;quot;&amp;quot;&amp;quot;\n        logger.info(&amp;quot;Testing RealNVP log-probability...&amp;quot;)\n    \n        model = ConditionalRealNVP(h_dim=64)\n    \n        x = torch.randn(4, 1, 28, 28)\n        y = torch.randn(4, 1, 28, 28)\n    \n        z_final, z_factored_list, log_det, log_prob = model.forward(x, y)\n    \n        # Check log_prob shape\n        assert log_prob.shape == (4,), f&amp;quot;Log-prob shape mismatch: expected (4,), got {log_prob.shape}&amp;quot;\n    \n        # Check reasonable values (should be negative for normalized distributions)\n        assert torch.all(torch.isfinite(log_prob)), &amp;quot;Non-finite log-prob values&amp;quot;\n    \n        mean_log_prob = log_prob.mean().item()\n        logger.info(f&amp;quot;  Mean log-prob: {mean_log_prob:.4f}&amp;quot;)\n        logger.info(f&amp;quot;  Log-prob range: [{log_prob.min().item():.2f}, {log_prob.max().item():.2f}]&amp;quot;)\n    \n        # Typically should be negative and reasonable magnitude\n        assert mean_log_prob &amp;lt; 0, &amp;quot;Log-prob should be negative&amp;quot;\n&amp;gt;       assert mean_log_prob &amp;gt; -1000, &amp;quot;Log-prob unreasonably negative&amp;quot;\nE       AssertionError: Log-prob unreasonably negative\nE       assert -1121.1993408203125 &amp;gt; -1000\n\ntests/test_conditioning.py:858: AssertionError\n\n----------------------------- Captured stdout call -----------------------------\nh norm: 1.519000768661499\ngamma range: [-0.13414175808429718, 0.16616390645503998]\nbeta range: [-0.16419772803783417, 0.1386972963809967]\nfeature norm before: 13.066751480102539\nfeature norm after: 1.720149040222168\nh norm: 1.519000768661499\ngamma range: [-0.1518685519695282, 0.11532063782215118]\nbeta range: [-0.17374184727668762, 0.1308988630771637]\nfeature norm before: 1.1474814414978027\nfeature norm after: 1.5152567625045776\nh norm: 1.519000768661499\ngamma range: [-0.13414175808429718, 0.16616390645503998]\nbeta range: [-0.16419772803783417, 0.1386972963809967]\nfeature norm before: 12.901254653930664\nfeature norm after: 1.7331609725952148\nh norm: 1.519000768661499\ngamma range: [-0.1518685519695282, 0.11532063782215118]\nbeta range: [-0.17374184727668762, 0.1308988630771637]\nfeature norm before: 1.0474848747253418\nfeature norm after: 1.5163764953613281\nh norm: 1.519000768661499\ngamma range: [-0.11853563040494919, 0.12644024193286896]\nbeta range: [-0.14653202891349792, 0.13905930519104004]\nfeature norm before: 13.090438842773438\nfeature norm after: 1.8518457412719727\nh norm: 1.519000768661499\ngamma range: [-0.1410495936870575, 0.14746427536010742]\nbeta range: [-0.14545060694217682, 0.14672738313674927]\nfeature norm before: 1.170507550239563\nfeature norm after: 1.7118546962738037\nh norm: 1.519000768661499\ngamma range: [-0.11853563040494919, 0.12644024193286896]\nbeta range: [-0.14653202891349792, 0.13905930519104004]\nfeature norm before: 12.801372528076172\nfeature norm after: 1.857147216796875\nh norm: 1.519000768661499\ngamma range: [-0.1410495936870575, 0.14746427536010742]\nbeta range: [-0.14545060694217682, 0.14672738313674927]\nfeature norm before: 1.000767469406128\nfeature norm after: 1.6995699405670166\nh norm: 1.519000768661499\ngamma range: [-0.1551465094089508, 0.1548444777727127]\nbeta range: [-0.1275882124900818, 0.1297425627708435]\nfeature norm before: 12.873835563659668\nfeature norm after: 1.7495137453079224\nh norm: 1.519000768661499\ngamma range: [-0.15990008413791656, 0.1219707652926445]\nbeta range: [-0.1398363560438156, 0.15050935745239258]\nfeature norm before: 1.0140972137451172\nfeature norm after: 1.667812466621399\nh norm: 1.519000768661499\ngamma range: [-0.1551465094089508, 0.1548444777727127]\nbeta range: [-0.1275882124900818, 0.1297425627708435]\nfeature norm before: 13.202998161315918\nfeature norm after: 1.754870891571045\nh norm: 1.519000768661499\ngamma range: [-0.15990008413791656, 0.1219707652926445]\nbeta range: [-0.1398363560438156, 0.15050935745239258]\nfeature norm before: 1.028464674949646\nfeature norm after: 1.672420859336853\nh norm: 1.519000768661499\ngamma range: [-0.14565160870552063, 0.1407497376203537]\nbeta range: [-0.15744441747665405, 0.1328655183315277]\nfeature norm before: 13.323759078979492\nfeature norm after: 1.8693369626998901\nh norm: 1.519000768661499\ngamma range: [-0.12529370188713074, 0.1383727490901947]\nbeta range: [-0.14466285705566406, 0.1351601481437683]\nfeature norm before: 1.1231385469436646\nfeature norm after: 1.6475398540496826\nh norm: 1.519000768661499\ngamma range: [-0.14565160870552063, 0.1407497376203537]\nbeta range: [-0.15744441747665405, 0.1328655183315277]\nfeature norm before: 13.616802215576172\nfeature norm after: 1.8279500007629395\nh norm: 1.519000768661499\ngamma range: [-0.12529370188713074, 0.1383727490901947]\nbeta range: [-0.14466285705566406, 0.1351601481437683]\nfeature norm before: 1.00489342212677\nfeature norm after: 1.6407127380371094\nh norm: 1.519000768661499\ngamma range: [-0.12864847481250763, 0.1502436101436615]\nbeta range: [-0.1244981586933136, 0.1445196270942688]\nfeature norm before: 13.281189918518066\nfeature norm after: 1.8952690362930298\nh norm: 1.519000768661499\ngamma range: [-0.12235715240240097, 0.13976871967315674]\nbeta range: [-0.13484936952590942, 0.15008829534053802]\nfeature norm before: 1.0818443298339844\nfeature norm after: 1.5962462425231934\nh norm: 1.519000768661499\ngamma range: [-0.12864847481250763, 0.1502436101436615]\nbeta range: [-0.1244981586933136, 0.1445196270942688]\nfeature norm before: 12.808699607849121\nfeature norm after: 1.882548213005066\nh norm: 1.519000768661499\ngamma range: [-0.12235715240240097, 0.13976871967315674]\nbeta range: [-0.13484936952590942, 0.15008829534053802]\nfeature norm before: 1.0882632732391357\nfeature norm after: 1.5972204208374023\nh norm: 1.519000768661499\ngamma range: [-0.1414777934551239, 0.1448228657245636]\nbeta range: [-0.13692614436149597, 0.14522096514701843]\nfeature norm before: 12.783184051513672\nfeature norm after: 1.809629201889038\nh norm: 1.519000768661499\ngamma range: [-0.14906957745552063, 0.15080882608890533]\nbeta range: [-0.139274463057518, 0.13358446955680847]\nfeature norm before: 1.106803059577942\nfeature norm after: 1.6152890920639038\nh norm: 1.519000768661499\ngamma range: [-0.1414777934551239, 0.1448228657245636]\nbeta range: [-0.13692614436149597, 0.14522096514701843]\nfeature norm before: 13.198257446289062\nfeature norm after: 1.8267401456832886\nh norm: 1.519000768661499\ngamma range: [-0.14906957745552063, 0.15080882608890533]\nbeta range: [-0.139274463057518, 0.13358446955680847]\nfeature norm before: 1.1498204469680786\nfeature norm after: 1.6181854009628296\nh norm: 1.519000768661499\ngamma range: [-0.13263621926307678, 0.14630506932735443]\nbeta range: [-0.10779184103012085, 0.12475898116827011]\nfeature norm before: 13.48319149017334\nfeature norm after: 1.737147331237793\nh norm: 1.519000768661499\ngamma range: [-0.16092616319656372, 0.1349869966506958]\nbeta range: [-0.12406579405069351, 0.14767754077911377]\nfeature norm before: 1.1359937191009521\nfeature norm after: 1.6485143899917603\nh norm: 1.519000768661499\ngamma range: [-0.13263621926307678, 0.14630506932735443]\nbeta range: [-0.10779184103012085, 0.12475898116827011]\nfeature norm before: 13.220475196838379\nfeature norm after: 1.7293862104415894\nh norm: 1.519000768661499\ngamma range: [-0.16092616319656372, 0.1349869966506958]\nbeta range: [-0.12406579405069351, 0.14767754077911377]\nfeature norm before: 1.1552175283432007\nfeature norm after: 1.6456223726272583\nh norm: 1.519000768661499\ngamma range: [-0.15378940105438232, 0.13779065012931824]\nbeta range: [-0.13609600067138672, 0.15265914797782898]\nfeature norm before: 13.61850357055664\nfeature norm after: 1.8949239253997803\nh norm: 1.519000768661499\ngamma range: [-0.1304176151752472, 0.1318242847919464]\nbeta range: [-0.14363811910152435, 0.12436184287071228]\nfeature norm before: 1.0676565170288086\nfeature norm after: 1.6081982851028442\nh norm: 1.519000768661499\ngamma range: [-0.15378940105438232, 0.13779065012931824]\nbeta range: [-0.13609600067138672, 0.15265914797782898]\nfeature norm before: 13.173685073852539\nfeature norm after: 1.838896632194519\nh norm: 1.519000768661499\ngamma range: [-0.1304176151752472, 0.1318242847919464]\nbeta range: [-0.14363811910152435, 0.12436184287071228]\nfeature norm before: 1.1382607221603394\nfeature norm after: 1.6062705516815186\nh norm: 1.519000768661499\ngamma range: [-0.1338208019733429, 0.1343594491481781]\nbeta range: [-0.1267549991607666, 0.1370714008808136]\nfeature norm before: 13.287154197692871\nfeature norm after: 1.6875237226486206\nh norm: 1.519000768661499\ngamma range: [-0.14201079308986664, 0.13128548860549927]\nbeta range: [-0.14525119960308075, 0.1765342801809311]\nfeature norm before: 1.048155665397644\nfeature norm after: 1.6492799520492554\nh norm: 1.519000768661499\ngamma range: [-0.1338208019733429, 0.1343594491481781]\nbeta range: [-0.1267549991607666, 0.1370714008808136]\nfeature norm before: 12.825957298278809\nfeature norm after: 1.6877998113632202\nh norm: 1.519000768661499\ngamma range: [-0.14201079308986664, 0.13128548860549927]\nbeta range: [-0.14525119960308075, 0.1765342801809311]\nfeature norm before: 0.9757859706878662\nfeature norm after: 1.64919114112854\n&#34;}], &#34;tests/test_conditioning.py::test_maf_invertibility&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Skipped&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_maf_invertibility&#34;, &#34;duration&#34;: &#34;742 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Skipped&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_maf_invertibility&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;742 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;(&amp;#x27;/home/benjamin/Documents/CSMF/tests/test_conditioning.py&amp;#x27;, 900, &amp;#x27;Skipped: MAF not available: MAF invertibility failed: error=2.854118824005127\\nassert 2.854118824005127 &amp;lt; 0.001&amp;#x27;)\n\n------------------------------ Captured log call -------------------------------\nERROR    tests.test_conditioning:test_conditioning.py:891   \u2717 MAF invertibility FAILED!\nERROR    tests.test_conditioning:test_conditioning.py:892     Expected: &amp;lt; 1e-3\nERROR    tests.test_conditioning:test_conditioning.py:893     Got: 2.85e+00\nWARNING  tests.test_conditioning:test_conditioning.py:899 MAF test failed (may not be implemented yet): MAF invertibility failed: error=2.854118824005127\nassert 2.854118824005127 &amp;lt; 0.001\n\n&#34;}], &#34;tests/test_conditioning.py::test_maf_made_masking&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Skipped&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_maf_made_masking&#34;, &#34;duration&#34;: &#34;39 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Skipped&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_maf_made_masking&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;39 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;(&amp;#x27;/home/benjamin/Documents/CSMF/tests/test_conditioning.py&amp;#x27;, 970, &amp;#x27;Skipped: MAF MADE not available: mat1 and mat2 shapes cannot be multiplied (2x1 and 8x128)&amp;#x27;)\n\n------------------------------ Captured log call -------------------------------\nWARNING  tests.test_conditioning:test_conditioning.py:969 MAF MADE test failed (may not be implemented yet): mat1 and mat2 shapes cannot be multiplied (2x1 and 8x128)\n\n&#34;}], &#34;tests/test_conditioning.py::test_maf_parallel_forward&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_maf_parallel_forward&#34;, &#34;duration&#34;: &#34;7 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_maf_parallel_forward&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;7 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;tests/test_conditioning.py::test_maf_sequential_inverse&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_maf_sequential_inverse&#34;, &#34;duration&#34;: &#34;542 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_maf_sequential_inverse&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;542 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;tests/test_conditioning.py::test_full_pipeline&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_full_pipeline&#34;, &#34;duration&#34;: &#34;52 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_full_pipeline&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;52 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nh norm: 1.314023733139038\ngamma range: [-0.12025906145572662, 0.14853531122207642]\nbeta range: [-0.11827311664819717, 0.1481899917125702]\nfeature norm before: 0.6770850419998169\nfeature norm after: 1.6490395069122314\nh norm: 1.314023733139038\ngamma range: [-0.12579435110092163, 0.136276513338089]\nbeta range: [-0.1279028207063675, 0.12443459033966064]\nfeature norm before: 1.0942894220352173\nfeature norm after: 1.6150861978530884\nh norm: 1.314023733139038\ngamma range: [-0.12025906145572662, 0.14853531122207642]\nbeta range: [-0.11827311664819717, 0.1481899917125702]\nfeature norm before: 0.5956912040710449\nfeature norm after: 1.6465950012207031\nh norm: 1.314023733139038\ngamma range: [-0.12579435110092163, 0.136276513338089]\nbeta range: [-0.1279028207063675, 0.12443459033966064]\nfeature norm before: 1.0137766599655151\nfeature norm after: 1.60957670211792\nh norm: 1.314023733139038\ngamma range: [-0.14271841943264008, 0.13822464644908905]\nbeta range: [-0.17104724049568176, 0.13521194458007812]\nfeature norm before: 0.6964576840400696\nfeature norm after: 1.6562496423721313\nh norm: 1.314023733139038\ngamma range: [-0.16001057624816895, 0.12239745259284973]\nbeta range: [-0.1274755448102951, 0.12757521867752075]\nfeature norm before: 1.1177492141723633\nfeature norm after: 1.5930602550506592\nh norm: 1.314023733139038\ngamma range: [-0.14271841943264008, 0.13822464644908905]\nbeta range: [-0.17104724049568176, 0.13521194458007812]\nfeature norm before: 0.7039391994476318\nfeature norm after: 1.6571115255355835\nh norm: 1.314023733139038\ngamma range: [-0.16001057624816895, 0.12239745259284973]\nbeta range: [-0.1274755448102951, 0.12757521867752075]\nfeature norm before: 1.0292861461639404\nfeature norm after: 1.5955625772476196\nh norm: 1.314023733139038\ngamma range: [-0.1642339527606964, 0.11189843714237213]\nbeta range: [-0.1274295449256897, 0.1687692552804947]\nfeature norm before: 0.6390213966369629\nfeature norm after: 1.6561753749847412\nh norm: 1.314023733139038\ngamma range: [-0.14187438786029816, 0.13645552098751068]\nbeta range: [-0.14782214164733887, 0.11349242925643921]\nfeature norm before: 0.9648044109344482\nfeature norm after: 1.6416298151016235\nh norm: 1.314023733139038\ngamma range: [-0.1642339527606964, 0.11189843714237213]\nbeta range: [-0.1274295449256897, 0.1687692552804947]\nfeature norm before: 0.6877672076225281\nfeature norm after: 1.6546372175216675\nh norm: 1.314023733139038\ngamma range: [-0.14187438786029816, 0.13645552098751068]\nbeta range: [-0.14782214164733887, 0.11349242925643921]\nfeature norm before: 1.106406331062317\nfeature norm after: 1.640620470046997\nh norm: 1.314023733139038\ngamma range: [-0.1578153371810913, 0.135696679353714]\nbeta range: [-0.12795689702033997, 0.14264503121376038]\nfeature norm before: 0.8932462930679321\nfeature norm after: 1.6619186401367188\nh norm: 1.314023733139038\ngamma range: [-0.13848386704921722, 0.11816184222698212]\nbeta range: [-0.14215871691703796, 0.10803128033876419]\nfeature norm before: 0.9687255024909973\nfeature norm after: 1.5808135271072388\nh norm: 1.314023733139038\ngamma range: [-0.1578153371810913, 0.135696679353714]\nbeta range: [-0.12795689702033997, 0.14264503121376038]\nfeature norm before: 0.9384867548942566\nfeature norm after: 1.6602033376693726\nh norm: 1.314023733139038\ngamma range: [-0.13848386704921722, 0.11816184222698212]\nbeta range: [-0.14215871691703796, 0.10803128033876419]\nfeature norm before: 0.9785762429237366\nfeature norm after: 1.5865674018859863\nh norm: 1.314023733139038\ngamma range: [-0.13956338167190552, 0.1399213671684265]\nbeta range: [-0.12328147888183594, 0.13732798397541046]\nfeature norm before: 0.885636031627655\nfeature norm after: 1.656375527381897\nh norm: 1.314023733139038\ngamma range: [-0.1380782425403595, 0.1421748399734497]\nbeta range: [-0.18630078434944153, 0.1295527070760727]\nfeature norm before: 1.123584270477295\nfeature norm after: 1.728814721107483\nh norm: 1.314023733139038\ngamma range: [-0.13956338167190552, 0.1399213671684265]\nbeta range: [-0.12328147888183594, 0.13732798397541046]\nfeature norm before: 0.9615193009376526\nfeature norm after: 1.6508949995040894\nh norm: 1.314023733139038\ngamma range: [-0.1380782425403595, 0.1421748399734497]\nbeta range: [-0.18630078434944153, 0.1295527070760727]\nfeature norm before: 1.0804742574691772\nfeature norm after: 1.7315577268600464\nh norm: 1.314023733139038\ngamma range: [-0.14239910244941711, 0.1345958560705185]\nbeta range: [-0.14217598736286163, 0.12598077952861786]\nfeature norm before: 0.9363179802894592\nfeature norm after: 1.645804524421692\nh norm: 1.314023733139038\ngamma range: [-0.11066090315580368, 0.18704386055469513]\nbeta range: [-0.12370118498802185, 0.14039990305900574]\nfeature norm before: 0.9936301708221436\nfeature norm after: 1.5949699878692627\nh norm: 1.314023733139038\ngamma range: [-0.14239910244941711, 0.1345958560705185]\nbeta range: [-0.14217598736286163, 0.12598077952861786]\nfeature norm before: 0.9426460266113281\nfeature norm after: 1.6464440822601318\nh norm: 1.314023733139038\ngamma range: [-0.11066090315580368, 0.18704386055469513]\nbeta range: [-0.12370118498802185, 0.14039990305900574]\nfeature norm before: 1.0608974695205688\nfeature norm after: 1.5933036804199219\nh norm: 1.314023733139038\ngamma range: [-0.11837580054998398, 0.14117535948753357]\nbeta range: [-0.1087321788072586, 0.14704935252666473]\nfeature norm before: 1.2861113548278809\nfeature norm after: 1.5309408903121948\nh norm: 1.314023733139038\ngamma range: [-0.11141986399888992, 0.1014169231057167]\nbeta range: [-0.12743613123893738, 0.12364178895950317]\nfeature norm before: 1.0584064722061157\nfeature norm after: 1.5612311363220215\nh norm: 1.314023733139038\ngamma range: [-0.11837580054998398, 0.14117535948753357]\nbeta range: [-0.1087321788072586, 0.14704935252666473]\nfeature norm before: 1.2475817203521729\nfeature norm after: 1.532569169998169\nh norm: 1.314023733139038\ngamma range: [-0.11141986399888992, 0.1014169231057167]\nbeta range: [-0.12743613123893738, 0.12364178895950317]\nfeature norm before: 0.991588830947876\nfeature norm after: 1.56071937084198\nh norm: 1.314023733139038\ngamma range: [-0.15609654784202576, 0.11070644110441208]\nbeta range: [-0.13596174120903015, 0.1281989961862564]\nfeature norm before: 1.4068793058395386\nfeature norm after: 1.6785221099853516\nh norm: 1.314023733139038\ngamma range: [-0.10995841026306152, 0.1510756015777588]\nbeta range: [-0.10975442826747894, 0.1278059184551239]\nfeature norm before: 1.0089877843856812\nfeature norm after: 1.5719763040542603\nh norm: 1.314023733139038\ngamma range: [-0.15609654784202576, 0.11070644110441208]\nbeta range: [-0.13596174120903015, 0.1281989961862564]\nfeature norm before: 1.251866102218628\nfeature norm after: 1.6758902072906494\nh norm: 1.314023733139038\ngamma range: [-0.10995841026306152, 0.1510756015777588]\nbeta range: [-0.10975442826747894, 0.1278059184551239]\nfeature norm before: 0.8921133875846863\nfeature norm after: 1.5730102062225342\nh norm: 1.314023733139038\ngamma range: [-0.12274973094463348, 0.1268804967403412]\nbeta range: [-0.10750386118888855, 0.13332021236419678]\nfeature norm before: 1.3269416093826294\nfeature norm after: 1.5881983041763306\nh norm: 1.314023733139038\ngamma range: [-0.1038859486579895, 0.12538999319076538]\nbeta range: [-0.12976768612861633, 0.1410033404827118]\nfeature norm before: 0.9895687103271484\nfeature norm after: 1.548388123512268\nh norm: 1.314023733139038\ngamma range: [-0.12274973094463348, 0.1268804967403412]\nbeta range: [-0.10750386118888855, 0.13332021236419678]\nfeature norm before: 1.3544695377349854\nfeature norm after: 1.5923866033554077\nh norm: 1.314023733139038\ngamma range: [-0.1038859486579895, 0.12538999319076538]\nbeta range: [-0.12976768612861633, 0.1410033404827118]\nfeature norm before: 0.9611741304397583\nfeature norm after: 1.5500421524047852\n&#34;}], &#34;tests/test_conditioning.py::test_conditioning_determinism&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_conditioning_determinism&#34;, &#34;duration&#34;: &#34;33 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_conditioning_determinism&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;33 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;@pytest.mark.critical\n    def test_conditioning_determinism():\n        &amp;quot;&amp;quot;&amp;quot;\n        CRITICAL: Different observations \u2192 different reconstructions\n    \n        This is the end-to-end test that validates the entire conditioning\n        mechanism works properly from observation to reconstruction.\n        &amp;quot;&amp;quot;&amp;quot;\n        logger.info(&amp;quot;Testing end-to-end conditioning determinism...&amp;quot;)\n        logger.info(&amp;quot;  [CRITICAL TEST - END-TO-END VALIDATION]&amp;quot;)\n    \n        try:\n            model = ConditionalRealNVP(h_dim=64)\n            model.eval()\n    \n            # Same clean image\n            x = torch.randn(1, 1, 28, 28)\n    \n            # Two different observations\n            y1 = torch.randn(1, 1, 28, 28)\n            y2 = torch.randn(1, 1, 28, 28)\n    \n            logger.info(&amp;quot;  Testing conditioning on same x with different y...&amp;quot;)\n    \n            # Forward with different observations\n            with torch.no_grad():\n                z1, z_fac1, log_det1, log_prob1 = model.forward(x, y1)\n                z2, z_fac2, log_det2, log_prob2 = model.forward(x, y2)\n    \n            # Latents should differ\n            z_diff = torch.norm(z1 - z2).item()\n            z_baseline = torch.norm(z1).item()\n            z_relative = z_diff / (z_baseline + 1e-8)\n    \n            logger.info(f&amp;quot;  Latent difference: {z_diff:.4f} (baseline: {z_baseline:.4f})&amp;quot;)\n            logger.info(f&amp;quot;  Relative difference: {z_relative:.4f}&amp;quot;)\n    \n            try:\n&amp;gt;               assert z_diff &amp;gt; 0.1, \\\n                    f&amp;quot;Conditioning too weak on latents: z_diff={z_diff:.4f}&amp;quot;\nE                   AssertionError: Conditioning too weak on latents: z_diff=0.0070\nE                   assert 0.0069643049500882626 &amp;gt; 0.1\n\ntests/test_conditioning.py:1134: AssertionError\n\n----------------------------- Captured stdout call -----------------------------\nh norm: 0.15628211200237274\ngamma range: [-0.13303375244140625, 0.12384414672851562]\nbeta range: [-0.11792658269405365, 0.1236928403377533]\nfeature norm before: 6.396625518798828\nfeature norm after: 0.828836977481842\nh norm: 0.15628211200237274\ngamma range: [-0.13267669081687927, 0.10083868354558945]\nbeta range: [-0.1180078536272049, 0.16972005367279053]\nfeature norm before: 0.5723395347595215\nfeature norm after: 0.7948317527770996\nh norm: 0.15628211200237274\ngamma range: [-0.13303375244140625, 0.12384414672851562]\nbeta range: [-0.11792658269405365, 0.1236928403377533]\nfeature norm before: 6.53530740737915\nfeature norm after: 0.7998912334442139\nh norm: 0.15628211200237274\ngamma range: [-0.13267669081687927, 0.10083868354558945]\nbeta range: [-0.1180078536272049, 0.16972005367279053]\nfeature norm before: 0.5196211338043213\nfeature norm after: 0.7921445965766907\nh norm: 0.15628211200237274\ngamma range: [-0.13777489960193634, 0.10766701400279999]\nbeta range: [-0.11221125721931458, 0.11315171420574188]\nfeature norm before: 6.0753607749938965\nfeature norm after: 0.801334023475647\nh norm: 0.15628211200237274\ngamma range: [-0.11905670166015625, 0.13857829570770264]\nbeta range: [-0.12004131078720093, 0.12429489195346832]\nfeature norm before: 0.5186254978179932\nfeature norm after: 0.7308391332626343\nh norm: 0.15628211200237274\ngamma range: [-0.13777489960193634, 0.10766701400279999]\nbeta range: [-0.11221125721931458, 0.11315171420574188]\nfeature norm before: 5.985815048217773\nfeature norm after: 0.7891043424606323\nh norm: 0.15628211200237274\ngamma range: [-0.11905670166015625, 0.13857829570770264]\nbeta range: [-0.12004131078720093, 0.12429489195346832]\nfeature norm before: 0.5066500306129456\nfeature norm after: 0.7305938601493835\nh norm: 0.15628211200237274\ngamma range: [-0.11607606709003448, 0.11237667500972748]\nbeta range: [-0.11803172528743744, 0.10438305139541626]\nfeature norm before: 6.424771785736084\nfeature norm after: 0.7381010055541992\nh norm: 0.15628211200237274\ngamma range: [-0.13475102186203003, 0.1323709934949875]\nbeta range: [-0.12121499329805374, 0.12809766829013824]\nfeature norm before: 0.4246925413608551\nfeature norm after: 0.742523729801178\nh norm: 0.15628211200237274\ngamma range: [-0.11607606709003448, 0.11237667500972748]\nbeta range: [-0.11803172528743744, 0.10438305139541626]\nfeature norm before: 6.1049885749816895\nfeature norm after: 0.7424079179763794\nh norm: 0.15628211200237274\ngamma range: [-0.13475102186203003, 0.1323709934949875]\nbeta range: [-0.12121499329805374, 0.12809766829013824]\nfeature norm before: 0.4993894696235657\nfeature norm after: 0.7412489056587219\nh norm: 0.15628211200237274\ngamma range: [-0.12196643650531769, 0.11268101632595062]\nbeta range: [-0.12124510854482651, 0.13071775436401367]\nfeature norm before: 6.538198471069336\nfeature norm after: 0.8470760583877563\nh norm: 0.15628211200237274\ngamma range: [-0.11509539932012558, 0.11221709102392197]\nbeta range: [-0.10921799391508102, 0.12204454839229584]\nfeature norm before: 0.554268479347229\nfeature norm after: 0.7566295862197876\nh norm: 0.15628211200237274\ngamma range: [-0.12196643650531769, 0.11268101632595062]\nbeta range: [-0.12124510854482651, 0.13071775436401367]\nfeature norm before: 6.895409107208252\nfeature norm after: 0.8580948114395142\nh norm: 0.15628211200237274\ngamma range: [-0.11509539932012558, 0.11221709102392197]\nbeta range: [-0.10921799391508102, 0.12204454839229584]\nfeature norm before: 0.5857061743736267\nfeature norm after: 0.7578009963035583\nh norm: 0.15628211200237274\ngamma range: [-0.12898243963718414, 0.16442379355430603]\nbeta range: [-0.10559907555580139, 0.11187494546175003]\nfeature norm before: 6.600331783294678\nfeature norm after: 0.8720342516899109\nh norm: 0.15628211200237274\ngamma range: [-0.11455526947975159, 0.11803103238344193]\nbeta range: [-0.11703957617282867, 0.12621256709098816]\nfeature norm before: 0.5058413743972778\nfeature norm after: 0.7083507180213928\nh norm: 0.15628211200237274\ngamma range: [-0.12898243963718414, 0.16442379355430603]\nbeta range: [-0.10559907555580139, 0.11187494546175003]\nfeature norm before: 6.917175769805908\nfeature norm after: 0.8021999001502991\nh norm: 0.15628211200237274\ngamma range: [-0.11455526947975159, 0.11803103238344193]\nbeta range: [-0.11703957617282867, 0.12621256709098816]\nfeature norm before: 0.5169171094894409\nfeature norm after: 0.7077972292900085\nh norm: 0.15628211200237274\ngamma range: [-0.11483287066221237, 0.10455821454524994]\nbeta range: [-0.1414090096950531, 0.12449707835912704]\nfeature norm before: 6.644675254821777\nfeature norm after: 0.8515475392341614\nh norm: 0.15628211200237274\ngamma range: [-0.13948869705200195, 0.10973852872848511]\nbeta range: [-0.11400222033262253, 0.13716748356819153]\nfeature norm before: 0.5713377594947815\nfeature norm after: 0.7561529874801636\nh norm: 0.15628211200237274\ngamma range: [-0.11483287066221237, 0.10455821454524994]\nbeta range: [-0.1414090096950531, 0.12449707835912704]\nfeature norm before: 6.5885329246521\nfeature norm after: 0.8058892488479614\nh norm: 0.15628211200237274\ngamma range: [-0.13948869705200195, 0.10973852872848511]\nbeta range: [-0.11400222033262253, 0.13716748356819153]\nfeature norm before: 0.5433545708656311\nfeature norm after: 0.754065752029419\nh norm: 0.15628211200237274\ngamma range: [-0.12290794402360916, 0.11995606869459152]\nbeta range: [-0.12036082148551941, 0.1373521387577057]\nfeature norm before: 5.884019374847412\nfeature norm after: 0.8334344625473022\nh norm: 0.15628211200237274\ngamma range: [-0.13404735922813416, 0.13729533553123474]\nbeta range: [-0.11265507340431213, 0.1342519223690033]\nfeature norm before: 0.5273546576499939\nfeature norm after: 0.7430773377418518\nh norm: 0.15628211200237274\ngamma range: [-0.12290794402360916, 0.11995606869459152]\nbeta range: [-0.12036082148551941, 0.1373521387577057]\nfeature norm before: 5.971377849578857\nfeature norm after: 0.8106767535209656\nh norm: 0.15628211200237274\ngamma range: [-0.13404735922813416, 0.13729533553123474]\nbeta range: [-0.11265507340431213, 0.1342519223690033]\nfeature norm before: 0.4904772937297821\nfeature norm after: 0.7423989176750183\nh norm: 0.15628211200237274\ngamma range: [-0.1130787581205368, 0.1200844794511795]\nbeta range: [-0.12859579920768738, 0.1257118284702301]\nfeature norm before: 6.300006866455078\nfeature norm after: 0.8236019611358643\nh norm: 0.15628211200237274\ngamma range: [-0.11564914882183075, 0.1304440200328827]\nbeta range: [-0.1298200935125351, 0.0919361561536789]\nfeature norm before: 0.5309147238731384\nfeature norm after: 0.7475598454475403\nh norm: 0.15628211200237274\ngamma range: [-0.1130787581205368, 0.1200844794511795]\nbeta range: [-0.12859579920768738, 0.1257118284702301]\nfeature norm before: 5.5932464599609375\nfeature norm after: 0.810916006565094\nh norm: 0.15628211200237274\ngamma range: [-0.11564914882183075, 0.1304440200328827]\nbeta range: [-0.1298200935125351, 0.0919361561536789]\nfeature norm before: 0.48848432302474976\nfeature norm after: 0.7461441159248352\nh norm: 0.15628211200237274\ngamma range: [-0.14002200961112976, 0.12562131881713867]\nbeta range: [-0.13245190680027008, 0.10604038089513779]\nfeature norm before: 5.639589786529541\nfeature norm after: 0.7800203561782837\nh norm: 0.15628211200237274\ngamma range: [-0.10044223070144653, 0.1341058909893036]\nbeta range: [-0.16245976090431213, 0.12322991341352463]\nfeature norm before: 0.5379830002784729\nfeature norm after: 0.748110830783844\nh norm: 0.15628211200237274\ngamma range: [-0.14002200961112976, 0.12562131881713867]\nbeta range: [-0.13245190680027008, 0.10604038089513779]\nfeature norm before: 5.773391246795654\nfeature norm after: 0.7776827216148376\nh norm: 0.15628211200237274\ngamma range: [-0.10044223070144653, 0.1341058909893036]\nbeta range: [-0.16245976090431213, 0.12322991341352463]\nfeature norm before: 0.555630087852478\nfeature norm after: 0.7468034625053406\nh norm: 0.15668022632598877\ngamma range: [-0.1332082748413086, 0.12381593137979507]\nbeta range: [-0.11805395781993866, 0.12364370375871658]\nfeature norm before: 6.396625518798828\nfeature norm after: 0.8284777998924255\nh norm: 0.15668022632598877\ngamma range: [-0.13271385431289673, 0.10088685899972916]\nbeta range: [-0.11807618290185928, 0.16990908980369568]\nfeature norm before: 0.5722804665565491\nfeature norm after: 0.794693648815155\nh norm: 0.15668022632598877\ngamma range: [-0.1332082748413086, 0.12381593137979507]\nbeta range: [-0.11805395781993866, 0.12364370375871658]\nfeature norm before: 6.53530740737915\nfeature norm after: 0.7995092272758484\nh norm: 0.15668022632598877\ngamma range: [-0.13271385431289673, 0.10088685899972916]\nbeta range: [-0.11807618290185928, 0.16990908980369568]\nfeature norm before: 0.5194454193115234\nfeature norm after: 0.7920011281967163\nh norm: 0.15668022632598877\ngamma range: [-0.13762208819389343, 0.10772474110126495]\nbeta range: [-0.11248421669006348, 0.11311616003513336]\nfeature norm before: 6.0753607749938965\nfeature norm after: 0.8012810349464417\nh norm: 0.15668022632598877\ngamma range: [-0.11908544600009918, 0.13871535658836365]\nbeta range: [-0.11998999118804932, 0.12429282814264297]\nfeature norm before: 0.5185253024101257\nfeature norm after: 0.7306756377220154\nh norm: 0.15668022632598877\ngamma range: [-0.13762208819389343, 0.10772474110126495]\nbeta range: [-0.11248421669006348, 0.11311616003513336]\nfeature norm before: 5.985815048217773\nfeature norm after: 0.7891120314598083\nh norm: 0.15668022632598877\ngamma range: [-0.11908544600009918, 0.13871535658836365]\nbeta range: [-0.11998999118804932, 0.12429282814264297]\nfeature norm before: 0.5064589381217957\nfeature norm after: 0.7304336428642273\nh norm: 0.15668022632598877\ngamma range: [-0.11606495082378387, 0.11243849247694016]\nbeta range: [-0.11783865839242935, 0.10413336753845215]\nfeature norm before: 6.424771785736084\nfeature norm after: 0.7379972338676453\nh norm: 0.15668022632598877\ngamma range: [-0.1349230855703354, 0.13234612345695496]\nbeta range: [-0.12107739597558975, 0.12827643752098083]\nfeature norm before: 0.42477548122406006\nfeature norm after: 0.7426427006721497\nh norm: 0.15668022632598877\ngamma range: [-0.11606495082378387, 0.11243849247694016]\nbeta range: [-0.11783865839242935, 0.10413336753845215]\nfeature norm before: 6.1049885749816895\nfeature norm after: 0.7421687841415405\nh norm: 0.15668022632598877\ngamma range: [-0.1349230855703354, 0.13234612345695496]\nbeta range: [-0.12107739597558975, 0.12827643752098083]\nfeature norm before: 0.49934354424476624\nfeature norm after: 0.741372287273407\nh norm: 0.15668022632598877\ngamma range: [-0.12200430780649185, 0.1126992404460907]\nbeta range: [-0.12116479873657227, 0.13066565990447998]\nfeature norm before: 6.538321495056152\nfeature norm after: 0.8473042845726013\nh norm: 0.15668022632598877\ngamma range: [-0.11496078222990036, 0.11241845786571503]\nbeta range: [-0.10929451882839203, 0.12218067049980164]\nfeature norm before: 0.5543646216392517\nfeature norm after: 0.7567651867866516\nh norm: 0.15668022632598877\ngamma range: [-0.12200430780649185, 0.1126992404460907]\nbeta range: [-0.12116479873657227, 0.13066565990447998]\nfeature norm before: 6.8955159187316895\nfeature norm after: 0.8582239151000977\nh norm: 0.15668022632598877\ngamma range: [-0.11496078222990036, 0.11241845786571503]\nbeta range: [-0.10929451882839203, 0.12218067049980164]\nfeature norm before: 0.5857128500938416\nfeature norm after: 0.7579379677772522\nh norm: 0.15668022632598877\ngamma range: [-0.12886860966682434, 0.16431625187397003]\nbeta range: [-0.10565589368343353, 0.1118994802236557]\nfeature norm before: 6.600533962249756\nfeature norm after: 0.872154951095581\nh norm: 0.15668022632598877\ngamma range: [-0.11449234932661057, 0.11803644150495529]\nbeta range: [-0.11712384223937988, 0.1260869801044464]\nfeature norm before: 0.505826473236084\nfeature norm after: 0.7083427309989929\nh norm: 0.15668022632598877\ngamma range: [-0.12886860966682434, 0.16431625187397003]\nbeta range: [-0.10565589368343353, 0.1118994802236557]\nfeature norm before: 6.917323589324951\nfeature norm after: 0.8023213744163513\nh norm: 0.15668022632598877\ngamma range: [-0.11449234932661057, 0.11803644150495529]\nbeta range: [-0.11712384223937988, 0.1260869801044464]\nfeature norm before: 0.5170186161994934\nfeature norm after: 0.7078080773353577\nh norm: 0.15668022632598877\ngamma range: [-0.11480462551116943, 0.10440767556428909]\nbeta range: [-0.1412358283996582, 0.12433388084173203]\nfeature norm before: 6.644261837005615\nfeature norm after: 0.8513475060462952\nh norm: 0.15668022632598877\ngamma range: [-0.139820858836174, 0.10990754514932632]\nbeta range: [-0.11401482671499252, 0.13696488738059998]\nfeature norm before: 0.5712567567825317\nfeature norm after: 0.7560904026031494\nh norm: 0.15668022632598877\ngamma range: [-0.11480462551116943, 0.10440767556428909]\nbeta range: [-0.1412358283996582, 0.12433388084173203]\nfeature norm before: 6.588576316833496\nfeature norm after: 0.8057689666748047\nh norm: 0.15668022632598877\ngamma range: [-0.139820858836174, 0.10990754514932632]\nbeta range: [-0.11401482671499252, 0.13696488738059998]\nfeature norm before: 0.5434012413024902\nfeature norm after: 0.7540005445480347\nh norm: 0.15668022632598877\ngamma range: [-0.12296975404024124, 0.12004050612449646]\nbeta range: [-0.12059900164604187, 0.13718736171722412]\nfeature norm before: 5.884241580963135\nfeature norm after: 0.8336479067802429\nh norm: 0.15668022632598877\ngamma range: [-0.13408829271793365, 0.1375586986541748]\nbeta range: [-0.11278391629457474, 0.13399478793144226]\nfeature norm before: 0.5273756384849548\nfeature norm after: 0.7431343793869019\nh norm: 0.15668022632598877\ngamma range: [-0.12296975404024124, 0.12004050612449646]\nbeta range: [-0.12059900164604187, 0.13718736171722412]\nfeature norm before: 5.971607208251953\nfeature norm after: 0.810879647731781\nh norm: 0.15668022632598877\ngamma range: [-0.13408829271793365, 0.1375586986541748]\nbeta range: [-0.11278391629457474, 0.13399478793144226]\nfeature norm before: 0.49060866236686707\nfeature norm after: 0.742479145526886\nh norm: 0.15668022632598877\ngamma range: [-0.1130460649728775, 0.12022129446268082]\nbeta range: [-0.12856173515319824, 0.12585210800170898]\nfeature norm before: 6.3001790046691895\nfeature norm after: 0.8235054016113281\nh norm: 0.15668022632598877\ngamma range: [-0.11582193523645401, 0.13049259781837463]\nbeta range: [-0.12976783514022827, 0.09214290231466293]\nfeature norm before: 0.5308904647827148\nfeature norm after: 0.747661828994751\nh norm: 0.15668022632598877\ngamma range: [-0.1130460649728775, 0.12022129446268082]\nbeta range: [-0.12856173515319824, 0.12585210800170898]\nfeature norm before: 5.593563556671143\nfeature norm after: 0.8108797669410706\nh norm: 0.15668022632598877\ngamma range: [-0.11582193523645401, 0.13049259781837463]\nbeta range: [-0.12976783514022827, 0.09214290231466293]\nfeature norm before: 0.4884565472602844\nfeature norm after: 0.7462489604949951\nh norm: 0.15668022632598877\ngamma range: [-0.13981539011001587, 0.12574835121631622]\nbeta range: [-0.13228115439414978, 0.10621608048677444]\nfeature norm before: 5.639699935913086\nfeature norm after: 0.7799692153930664\nh norm: 0.15668022632598877\ngamma range: [-0.1006084531545639, 0.13412722945213318]\nbeta range: [-0.16238823533058167, 0.12322434782981873]\nfeature norm before: 0.5378362536430359\nfeature norm after: 0.7483248710632324\nh norm: 0.15668022632598877\ngamma range: [-0.13981539011001587, 0.12574835121631622]\nbeta range: [-0.13228115439414978, 0.10621608048677444]\nfeature norm before: 5.773639678955078\nfeature norm after: 0.7776457667350769\nh norm: 0.15668022632598877\ngamma range: [-0.1006084531545639, 0.13412722945213318]\nbeta range: [-0.16238823533058167, 0.12322434782981873]\nfeature norm before: 0.5557065606117249\nfeature norm after: 0.7470195293426514\n\n------------------------------ Captured log call -------------------------------\nERROR    tests.test_conditioning:test_conditioning.py:1138   \u2717 Latent conditioning FAILED!\nERROR    tests.test_conditioning:test_conditioning.py:1139     Expected z_diff &amp;gt; 0.1\nERROR    tests.test_conditioning:test_conditioning.py:1140     Got: 0.0070\nERROR    tests.test_conditioning:test_conditioning.py:1141     Conditioning may not be working!\nERROR    tests.test_conditioning:test_conditioning.py:1183   \u2717 Conditioning determinism test FAILED: Conditioning too weak on latents: z_diff=0.0070\nassert 0.0069643049500882626 &amp;gt; 0.1\n\n&#34;}], &#34;tests/test_conditioning.py::test_gradient_flow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_gradient_flow&#34;, &#34;duration&#34;: &#34;207 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_gradient_flow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;207 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nh norm: 1.2148997783660889\ngamma range: [-0.12489771097898483, 0.12317737191915512]\nbeta range: [-0.12580546736717224, 0.15434718132019043]\nfeature norm before: 8.778846740722656\nfeature norm after: 1.3126389980316162\nh norm: 1.2148997783660889\ngamma range: [-0.12212418764829636, 0.13096386194229126]\nbeta range: [-0.12704777717590332, 0.1543414443731308]\nfeature norm before: 0.7497527599334717\nfeature norm after: 1.2033318281173706\nh norm: 1.2148997783660889\ngamma range: [-0.12489771097898483, 0.12317737191915512]\nbeta range: [-0.12580546736717224, 0.15434718132019043]\nfeature norm before: 9.566097259521484\nfeature norm after: 1.3294419050216675\nh norm: 1.2148997783660889\ngamma range: [-0.12212418764829636, 0.13096386194229126]\nbeta range: [-0.12704777717590332, 0.1543414443731308]\nfeature norm before: 0.8832927942276001\nfeature norm after: 1.2023134231567383\nh norm: 1.2148997783660889\ngamma range: [-0.13595712184906006, 0.13701698184013367]\nbeta range: [-0.13144958019256592, 0.14413130283355713]\nfeature norm before: 9.043035507202148\nfeature norm after: 1.2714128494262695\nh norm: 1.2148997783660889\ngamma range: [-0.12810833752155304, 0.13912682235240936]\nbeta range: [-0.13976465165615082, 0.17883244156837463]\nfeature norm before: 0.8156318068504333\nfeature norm after: 1.255452036857605\nh norm: 1.2148997783660889\ngamma range: [-0.13595712184906006, 0.13701698184013367]\nbeta range: [-0.13144958019256592, 0.14413130283355713]\nfeature norm before: 9.18037223815918\nfeature norm after: 1.3208041191101074\nh norm: 1.2148997783660889\ngamma range: [-0.12810833752155304, 0.13912682235240936]\nbeta range: [-0.13976465165615082, 0.17883244156837463]\nfeature norm before: 0.7921198010444641\nfeature norm after: 1.254017949104309\nh norm: 1.2148997783660889\ngamma range: [-0.132529154419899, 0.12796546518802643]\nbeta range: [-0.1286945641040802, 0.11689469963312149]\nfeature norm before: 8.991129875183105\nfeature norm after: 1.3379234075546265\nh norm: 1.2148997783660889\ngamma range: [-0.1269208788871765, 0.1446235179901123]\nbeta range: [-0.15147744119167328, 0.17020395398139954]\nfeature norm before: 0.8804547190666199\nfeature norm after: 1.210176706314087\nh norm: 1.2148997783660889\ngamma range: [-0.132529154419899, 0.12796546518802643]\nbeta range: [-0.1286945641040802, 0.11689469963312149]\nfeature norm before: 9.149097442626953\nfeature norm after: 1.31843900680542\nh norm: 1.2148997783660889\ngamma range: [-0.1269208788871765, 0.1446235179901123]\nbeta range: [-0.15147744119167328, 0.17020395398139954]\nfeature norm before: 0.7722549438476562\nfeature norm after: 1.2102035284042358\nh norm: 1.2148997783660889\ngamma range: [-0.12214747816324234, 0.16801762580871582]\nbeta range: [-0.14813204109668732, 0.14276006817817688]\nfeature norm before: 9.72157096862793\nfeature norm after: 1.2629345655441284\nh norm: 1.2148997783660889\ngamma range: [-0.12317859381437302, 0.11837318539619446]\nbeta range: [-0.11953673511743546, 0.13524271547794342]\nfeature norm before: 0.8062772154808044\nfeature norm after: 1.0922578573226929\nh norm: 1.2148997783660889\ngamma range: [-0.12214747816324234, 0.16801762580871582]\nbeta range: [-0.14813204109668732, 0.14276006817817688]\nfeature norm before: 9.172099113464355\nfeature norm after: 1.268453598022461\nh norm: 1.2148997783660889\ngamma range: [-0.12317859381437302, 0.11837318539619446]\nbeta range: [-0.11953673511743546, 0.13524271547794342]\nfeature norm before: 0.7988128662109375\nfeature norm after: 1.0917224884033203\nh norm: 1.2148997783660889\ngamma range: [-0.12458983808755875, 0.1250317096710205]\nbeta range: [-0.12174669653177261, 0.14474168419837952]\nfeature norm before: 9.050667762756348\nfeature norm after: 1.1582765579223633\nh norm: 1.2148997783660889\ngamma range: [-0.1342727243900299, 0.12699945271015167]\nbeta range: [-0.15991002321243286, 0.17684787511825562]\nfeature norm before: 0.8084414601325989\nfeature norm after: 1.251341700553894\nh norm: 1.2148997783660889\ngamma range: [-0.12458983808755875, 0.1250317096710205]\nbeta range: [-0.12174669653177261, 0.14474168419837952]\nfeature norm before: 10.126401901245117\nfeature norm after: 1.1935895681381226\nh norm: 1.2148997783660889\ngamma range: [-0.1342727243900299, 0.12699945271015167]\nbeta range: [-0.15991002321243286, 0.17684787511825562]\nfeature norm before: 0.7231435179710388\nfeature norm after: 1.2566123008728027\nh norm: 1.2148997783660889\ngamma range: [-0.14973732829093933, 0.14192050695419312]\nbeta range: [-0.1493360996246338, 0.13340358436107635]\nfeature norm before: 9.68983268737793\nfeature norm after: 1.2764960527420044\nh norm: 1.2148997783660889\ngamma range: [-0.17027783393859863, 0.15406537055969238]\nbeta range: [-0.15429112315177917, 0.14712455868721008]\nfeature norm before: 0.7833004593849182\nfeature norm after: 1.220765471458435\nh norm: 1.2148997783660889\ngamma range: [-0.14973732829093933, 0.14192050695419312]\nbeta range: [-0.1493360996246338, 0.13340358436107635]\nfeature norm before: 9.432948112487793\nfeature norm after: 1.2356115579605103\nh norm: 1.2148997783660889\ngamma range: [-0.17027783393859863, 0.15406537055969238]\nbeta range: [-0.15429112315177917, 0.14712455868721008]\nfeature norm before: 0.7789198756217957\nfeature norm after: 1.221832275390625\nh norm: 1.2148997783660889\ngamma range: [-0.15404382348060608, 0.13587215542793274]\nbeta range: [-0.1365559995174408, 0.11990801244974136]\nfeature norm before: 9.636476516723633\nfeature norm after: 1.350448489189148\nh norm: 1.2148997783660889\ngamma range: [-0.15347915887832642, 0.12063214927911758]\nbeta range: [-0.14706483483314514, 0.1322493553161621]\nfeature norm before: 0.8435943126678467\nfeature norm after: 1.0963743925094604\nh norm: 1.2148997783660889\ngamma range: [-0.15404382348060608, 0.13587215542793274]\nbeta range: [-0.1365559995174408, 0.11990801244974136]\nfeature norm before: 9.31070327758789\nfeature norm after: 1.3018338680267334\nh norm: 1.2148997783660889\ngamma range: [-0.15347915887832642, 0.12063214927911758]\nbeta range: [-0.14706483483314514, 0.1322493553161621]\nfeature norm before: 0.7689141631126404\nfeature norm after: 1.0946048498153687\nh norm: 1.2148997783660889\ngamma range: [-0.13528606295585632, 0.13019856810569763]\nbeta range: [-0.14696040749549866, 0.1409786343574524]\nfeature norm before: 8.841626167297363\nfeature norm after: 1.275498628616333\nh norm: 1.2148997783660889\ngamma range: [-0.1447649747133255, 0.1418830156326294]\nbeta range: [-0.16076791286468506, 0.12091690301895142]\nfeature norm before: 0.7368061542510986\nfeature norm after: 1.1406900882720947\nh norm: 1.2148997783660889\ngamma range: [-0.13528606295585632, 0.13019856810569763]\nbeta range: [-0.14696040749549866, 0.1409786343574524]\nfeature norm before: 8.951781272888184\nfeature norm after: 1.3030375242233276\nh norm: 1.2148997783660889\ngamma range: [-0.1447649747133255, 0.1418830156326294]\nbeta range: [-0.16076791286468506, 0.12091690301895142]\nfeature norm before: 0.7770812511444092\nfeature norm after: 1.1401716470718384\nh norm: 1.2148997783660889\ngamma range: [-0.10919495671987534, 0.1284181922674179]\nbeta range: [-0.12443616986274719, 0.13295325636863708]\nfeature norm before: 9.063986778259277\nfeature norm after: 1.1541674137115479\nh norm: 1.2148997783660889\ngamma range: [-0.13450294733047485, 0.13250404596328735]\nbeta range: [-0.17797794938087463, 0.13135498762130737]\nfeature norm before: 0.7916569709777832\nfeature norm after: 1.0899436473846436\nh norm: 1.2148997783660889\ngamma range: [-0.10919495671987534, 0.1284181922674179]\nbeta range: [-0.12443616986274719, 0.13295325636863708]\nfeature norm before: 9.458529472351074\nfeature norm after: 1.1541547775268555\nh norm: 1.2148997783660889\ngamma range: [-0.13450294733047485, 0.13250404596328735]\nbeta range: [-0.17797794938087463, 0.13135498762130737]\nfeature norm before: 0.7811713814735413\nfeature norm after: 1.089489459991455\n&#34;}], &#34;tests/test_conditioning.py::test_numerical_stability&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/test_conditioning.py::test_numerical_stability&#34;, &#34;duration&#34;: &#34;43 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/test_conditioning.py::test_numerical_stability&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;43 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nh norm: 1.1790014505386353\ngamma range: [-0.1467227339744568, 0.13723479211330414]\nbeta range: [-0.12645095586776733, 0.11712811887264252]\nfeature norm before: 9.706609725952148\nfeature norm after: 1.1910920143127441\nh norm: 1.1790014505386353\ngamma range: [-0.1546802818775177, 0.1408601701259613]\nbeta range: [-0.12382879108190536, 0.12364806234836578]\nfeature norm before: 0.7431119084358215\nfeature norm after: 1.1122440099716187\nh norm: 1.1790014505386353\ngamma range: [-0.1467227339744568, 0.13723479211330414]\nbeta range: [-0.12645095586776733, 0.11712811887264252]\nfeature norm before: 9.044046401977539\nfeature norm after: 1.2461285591125488\nh norm: 1.1790014505386353\ngamma range: [-0.1546802818775177, 0.1408601701259613]\nbeta range: [-0.12382879108190536, 0.12364806234836578]\nfeature norm before: 0.7644120454788208\nfeature norm after: 1.1133569478988647\nh norm: 1.1790014505386353\ngamma range: [-0.12946483492851257, 0.15606173872947693]\nbeta range: [-0.10701346397399902, 0.1210571750998497]\nfeature norm before: 9.754183769226074\nfeature norm after: 1.2478225231170654\nh norm: 1.1790014505386353\ngamma range: [-0.12604962289333344, 0.11397893726825714]\nbeta range: [-0.10916300117969513, 0.15104234218597412]\nfeature norm before: 0.7610121369361877\nfeature norm after: 1.1869388818740845\nh norm: 1.1790014505386353\ngamma range: [-0.12946483492851257, 0.15606173872947693]\nbeta range: [-0.10701346397399902, 0.1210571750998497]\nfeature norm before: 9.291366577148438\nfeature norm after: 1.236636757850647\nh norm: 1.1790014505386353\ngamma range: [-0.12604962289333344, 0.11397893726825714]\nbeta range: [-0.10916300117969513, 0.15104234218597412]\nfeature norm before: 0.7132657170295715\nfeature norm after: 1.1891862154006958\nh norm: 1.1790014505386353\ngamma range: [-0.16814503073692322, 0.15597374737262726]\nbeta range: [-0.12320560961961746, 0.17937816679477692]\nfeature norm before: 8.961400032043457\nfeature norm after: 1.2816100120544434\nh norm: 1.1790014505386353\ngamma range: [-0.15209603309631348, 0.16766542196273804]\nbeta range: [-0.1411972939968109, 0.14109589159488678]\nfeature norm before: 0.771540105342865\nfeature norm after: 1.1422441005706787\nh norm: 1.1790014505386353\ngamma range: [-0.16814503073692322, 0.15597374737262726]\nbeta range: [-0.12320560961961746, 0.17937816679477692]\nfeature norm before: 9.44054889678955\nfeature norm after: 1.349217176437378\nh norm: 1.1790014505386353\ngamma range: [-0.15209603309631348, 0.16766542196273804]\nbeta range: [-0.1411972939968109, 0.14109589159488678]\nfeature norm before: 0.742071270942688\nfeature norm after: 1.1376360654830933\nh norm: 1.1790014505386353\ngamma range: [-0.13792142271995544, 0.13946565985679626]\nbeta range: [-0.12367720156908035, 0.16983826458454132]\nfeature norm before: 9.343592643737793\nfeature norm after: 1.4337351322174072\nh norm: 1.1790014505386353\ngamma range: [-0.1536744385957718, 0.17350530624389648]\nbeta range: [-0.1246994286775589, 0.1329963207244873]\nfeature norm before: 0.8786521553993225\nfeature norm after: 1.1199263334274292\nh norm: 1.1790014505386353\ngamma range: [-0.13792142271995544, 0.13946565985679626]\nbeta range: [-0.12367720156908035, 0.16983826458454132]\nfeature norm before: 9.76594352722168\nfeature norm after: 1.487127661705017\nh norm: 1.1790014505386353\ngamma range: [-0.1536744385957718, 0.17350530624389648]\nbeta range: [-0.1246994286775589, 0.1329963207244873]\nfeature norm before: 0.7837681174278259\nfeature norm after: 1.125442385673523\nh norm: 1.1790014505386353\ngamma range: [-0.15373864769935608, 0.1431226283311844]\nbeta range: [-0.12681788206100464, 0.1567075252532959]\nfeature norm before: 9.47004508972168\nfeature norm after: 1.3683019876480103\nh norm: 1.1790014505386353\ngamma range: [-0.1287258118391037, 0.118631511926651]\nbeta range: [-0.17236939072608948, 0.1699065864086151]\nfeature norm before: 0.8330284357070923\nfeature norm after: 1.2493014335632324\nh norm: 1.1790014505386353\ngamma range: [-0.15373864769935608, 0.1431226283311844]\nbeta range: [-0.12681788206100464, 0.1567075252532959]\nfeature norm before: 8.771306037902832\nfeature norm after: 1.3471269607543945\nh norm: 1.1790014505386353\ngamma range: [-0.1287258118391037, 0.118631511926651]\nbeta range: [-0.17236939072608948, 0.1699065864086151]\nfeature norm before: 0.8692469000816345\nfeature norm after: 1.251230001449585\nh norm: 1.1790014505386353\ngamma range: [-0.14554435014724731, 0.11862783879041672]\nbeta range: [-0.14689365029335022, 0.1271776258945465]\nfeature norm before: 9.160382270812988\nfeature norm after: 1.262139916419983\nh norm: 1.1790014505386353\ngamma range: [-0.14417818188667297, 0.12364167720079422]\nbeta range: [-0.13624146580696106, 0.13694633543491364]\nfeature norm before: 0.7365716695785522\nfeature norm after: 1.1929315328598022\nh norm: 1.1790014505386353\ngamma range: [-0.14554435014724731, 0.11862783879041672]\nbeta range: [-0.14689365029335022, 0.1271776258945465]\nfeature norm before: 9.313140869140625\nfeature norm after: 1.2634385824203491\nh norm: 1.1790014505386353\ngamma range: [-0.14417818188667297, 0.12364167720079422]\nbeta range: [-0.13624146580696106, 0.13694633543491364]\nfeature norm before: 0.8026099801063538\nfeature norm after: 1.1943362951278687\nh norm: 1.1790014505386353\ngamma range: [-0.16951900720596313, 0.1395910680294037]\nbeta range: [-0.1260385513305664, 0.13223455846309662]\nfeature norm before: 8.970694541931152\nfeature norm after: 1.2593538761138916\nh norm: 1.1790014505386353\ngamma range: [-0.14027607440948486, 0.1335444450378418]\nbeta range: [-0.1314682811498642, 0.14156991243362427]\nfeature norm before: 0.7630475759506226\nfeature norm after: 1.2636345624923706\nh norm: 1.1790014505386353\ngamma range: [-0.16951900720596313, 0.1395910680294037]\nbeta range: [-0.1260385513305664, 0.13223455846309662]\nfeature norm before: 9.460868835449219\nfeature norm after: 1.257387638092041\nh norm: 1.1790014505386353\ngamma range: [-0.14027607440948486, 0.1335444450378418]\nbeta range: [-0.1314682811498642, 0.14156991243362427]\nfeature norm before: 0.8109315037727356\nfeature norm after: 1.264342188835144\nh norm: 1.1790014505386353\ngamma range: [-0.14633560180664062, 0.13161171972751617]\nbeta range: [-0.13028758764266968, 0.12122174352407455]\nfeature norm before: 9.041873931884766\nfeature norm after: 1.2679072618484497\nh norm: 1.1790014505386353\ngamma range: [-0.13831618428230286, 0.12919077277183533]\nbeta range: [-0.10185162723064423, 0.16972559690475464]\nfeature norm before: 0.8130255937576294\nfeature norm after: 1.1795533895492554\nh norm: 1.1790014505386353\ngamma range: [-0.14633560180664062, 0.13161171972751617]\nbeta range: [-0.13028758764266968, 0.12122174352407455]\nfeature norm before: 9.384177207946777\nfeature norm after: 1.2403849363327026\nh norm: 1.1790014505386353\ngamma range: [-0.13831618428230286, 0.12919077277183533]\nbeta range: [-0.10185162723064423, 0.16972559690475464]\nfeature norm before: 0.8634234070777893\nfeature norm after: 1.1789156198501587\nh norm: 1.1790014505386353\ngamma range: [-0.11876804381608963, 0.1679961383342743]\nbeta range: [-0.13035765290260315, 0.1316782534122467]\nfeature norm before: 9.446135520935059\nfeature norm after: 1.29733145236969\nh norm: 1.1790014505386353\ngamma range: [-0.12372200191020966, 0.12342647463083267]\nbeta range: [-0.15889781713485718, 0.1345784068107605]\nfeature norm before: 0.8332227468490601\nfeature norm after: 1.2144359350204468\nh norm: 1.1790014505386353\ngamma range: [-0.11876804381608963, 0.1679961383342743]\nbeta range: [-0.13035765290260315, 0.1316782534122467]\nfeature norm before: 8.313274383544922\nfeature norm after: 1.2648440599441528\nh norm: 1.1790014505386353\ngamma range: [-0.12372200191020966, 0.12342647463083267]\nbeta range: [-0.15889781713485718, 0.1345784068107605]\nfeature norm before: 0.7813265919685364\nfeature norm after: 1.215899109840393\nh norm: 1.1787205934524536\ngamma range: [-0.1465674638748169, 0.13424909114837646]\nbeta range: [-0.1212259829044342, 0.1138191670179367]\nfeature norm before: 9.169193267822266\nfeature norm after: 1.2025567293167114\nh norm: 1.1787205934524536\ngamma range: [-0.15777477622032166, 0.1425449401140213]\nbeta range: [-0.12197413295507431, 0.11853627115488052]\nfeature norm before: 0.7534213066101074\nfeature norm after: 1.1100363731384277\nh norm: 1.1787205934524536\ngamma range: [-0.1465674638748169, 0.13424909114837646]\nbeta range: [-0.1212259829044342, 0.1138191670179367]\nfeature norm before: 9.619646072387695\nfeature norm after: 1.2133498191833496\nh norm: 1.1787205934524536\ngamma range: [-0.15777477622032166, 0.1425449401140213]\nbeta range: [-0.12197413295507431, 0.11853627115488052]\nfeature norm before: 0.7668176293373108\nfeature norm after: 1.1113922595977783\nh norm: 1.1787205934524536\ngamma range: [-0.1270873248577118, 0.15171575546264648]\nbeta range: [-0.10722765326499939, 0.12300226837396622]\nfeature norm before: 8.93068790435791\nfeature norm after: 1.1748512983322144\nh norm: 1.1787205934524536\ngamma range: [-0.12960928678512573, 0.11444114148616791]\nbeta range: [-0.1102687194943428, 0.15161636471748352]\nfeature norm before: 0.7525326013565063\nfeature norm after: 1.194822072982788\nh norm: 1.1787205934524536\ngamma range: [-0.1270873248577118, 0.15171575546264648]\nbeta range: [-0.10722765326499939, 0.12300226837396622]\nfeature norm before: 9.960250854492188\nfeature norm after: 1.200758457183838\nh norm: 1.1787205934524536\ngamma range: [-0.12960928678512573, 0.11444114148616791]\nbeta range: [-0.1102687194943428, 0.15161636471748352]\nfeature norm before: 0.7057234048843384\nfeature norm after: 1.1967521905899048\nh norm: 1.1787205934524536\ngamma range: [-0.1720862239599228, 0.15509077906608582]\nbeta range: [-0.12234832346439362, 0.178053081035614]\nfeature norm before: 9.389754295349121\nfeature norm after: 1.2721868753433228\nh norm: 1.1787205934524536\ngamma range: [-0.15068525075912476, 0.1640838086605072]\nbeta range: [-0.1340453326702118, 0.14030276238918304]\nfeature norm before: 0.7497738599777222\nfeature norm after: 1.1382993459701538\nh norm: 1.1787205934524536\ngamma range: [-0.1720862239599228, 0.15509077906608582]\nbeta range: [-0.12234832346439362, 0.178053081035614]\nfeature norm before: 9.266427040100098\nfeature norm after: 1.28255033493042\nh norm: 1.1787205934524536\ngamma range: [-0.15068525075912476, 0.1640838086605072]\nbeta range: [-0.1340453326702118, 0.14030276238918304]\nfeature norm before: 0.7378885746002197\nfeature norm after: 1.1342037916183472\nh norm: 1.1787205934524536\ngamma range: [-0.13840730488300323, 0.13460169732570648]\nbeta range: [-0.12405849248170853, 0.17032404243946075]\nfeature norm before: 8.727081298828125\nfeature norm after: 1.4078195095062256\nh norm: 1.1787205934524536\ngamma range: [-0.15297161042690277, 0.16522690653800964]\nbeta range: [-0.1226915493607521, 0.13493093848228455]\nfeature norm before: 0.8658463954925537\nfeature norm after: 1.1157547235488892\nh norm: 1.1787205934524536\ngamma range: [-0.13840730488300323, 0.13460169732570648]\nbeta range: [-0.12405849248170853, 0.17032404243946075]\nfeature norm before: 9.409307479858398\nfeature norm after: 1.4689382314682007\nh norm: 1.1787205934524536\ngamma range: [-0.15297161042690277, 0.16522690653800964]\nbeta range: [-0.1226915493607521, 0.13493093848228455]\nfeature norm before: 0.757473886013031\nfeature norm after: 1.1226935386657715\nh norm: 1.1787205934524536\ngamma range: [-0.15315774083137512, 0.13675141334533691]\nbeta range: [-0.12567086517810822, 0.15362852811813354]\nfeature norm before: 9.029300689697266\nfeature norm after: 1.3664450645446777\nh norm: 1.1787205934524536\ngamma range: [-0.12348195910453796, 0.11589839309453964]\nbeta range: [-0.17350147664546967, 0.17036113142967224]\nfeature norm before: 0.8295567035675049\nfeature norm after: 1.248942255973816\nh norm: 1.1787205934524536\ngamma range: [-0.15315774083137512, 0.13675141334533691]\nbeta range: [-0.12567086517810822, 0.15362852811813354]\nfeature norm before: 8.600846290588379\nfeature norm after: 1.3135929107666016\nh norm: 1.1787205934524536\ngamma range: [-0.12348195910453796, 0.11589839309453964]\nbeta range: [-0.17350147664546967, 0.17036113142967224]\nfeature norm before: 0.8571251034736633\nfeature norm after: 1.2501697540283203\nh norm: 1.1787205934524536\ngamma range: [-0.1430385261774063, 0.11891397088766098]\nbeta range: [-0.1396562159061432, 0.12467511743307114]\nfeature norm before: 9.143488883972168\nfeature norm after: 1.2631049156188965\nh norm: 1.1787205934524536\ngamma range: [-0.14525145292282104, 0.12233493477106094]\nbeta range: [-0.13594266772270203, 0.13718444108963013]\nfeature norm before: 0.735965371131897\nfeature norm after: 1.186262607574463\nh norm: 1.1787205934524536\ngamma range: [-0.1430385261774063, 0.11891397088766098]\nbeta range: [-0.1396562159061432, 0.12467511743307114]\nfeature norm before: 10.003762245178223\nfeature norm after: 1.3175764083862305\nh norm: 1.1787205934524536\ngamma range: [-0.14525145292282104, 0.12233493477106094]\nbeta range: [-0.13594266772270203, 0.13718444108963013]\nfeature norm before: 0.8021007180213928\nfeature norm after: 1.1878200769424438\nh norm: 1.1787205934524536\ngamma range: [-0.16798144578933716, 0.1388537585735321]\nbeta range: [-0.12842842936515808, 0.1388230174779892]\nfeature norm before: 9.044448852539062\nfeature norm after: 1.248639464378357\nh norm: 1.1787205934524536\ngamma range: [-0.14665895700454712, 0.13844384253025055]\nbeta range: [-0.1345849335193634, 0.14449504017829895]\nfeature norm before: 0.7614662647247314\nfeature norm after: 1.2733654975891113\nh norm: 1.1787205934524536\ngamma range: [-0.16798144578933716, 0.1388537585735321]\nbeta range: [-0.12842842936515808, 0.1388230174779892]\nfeature norm before: 9.16345500946045\nfeature norm after: 1.250548243522644\nh norm: 1.1787205934524536\ngamma range: [-0.14665895700454712, 0.13844384253025055]\nbeta range: [-0.1345849335193634, 0.14449504017829895]\nfeature norm before: 0.7961602210998535\nfeature norm after: 1.2739320993423462\nh norm: 1.1787205934524536\ngamma range: [-0.14156967401504517, 0.1265030801296234]\nbeta range: [-0.12955227494239807, 0.12087465822696686]\nfeature norm before: 9.43325138092041\nfeature norm after: 1.2809958457946777\nh norm: 1.1787205934524536\ngamma range: [-0.1374892294406891, 0.13209258019924164]\nbeta range: [-0.09796404093503952, 0.17102937400341034]\nfeature norm before: 0.813598096370697\nfeature norm after: 1.1782035827636719\nh norm: 1.1787205934524536\ngamma range: [-0.14156967401504517, 0.1265030801296234]\nbeta range: [-0.12955227494239807, 0.12087465822696686]\nfeature norm before: 9.50334358215332\nfeature norm after: 1.2359110116958618\nh norm: 1.1787205934524536\ngamma range: [-0.1374892294406891, 0.13209258019924164]\nbeta range: [-0.09796404093503952, 0.17102937400341034]\nfeature norm before: 0.8862374424934387\nfeature norm after: 1.1783503293991089\nh norm: 1.1787205934524536\ngamma range: [-0.11985763162374496, 0.16874036192893982]\nbeta range: [-0.1286344975233078, 0.12664687633514404]\nfeature norm before: 9.693227767944336\nfeature norm after: 1.2893271446228027\nh norm: 1.1787205934524536\ngamma range: [-0.12496405094861984, 0.12331799417734146]\nbeta range: [-0.1603546142578125, 0.1331469714641571]\nfeature norm before: 0.8508733510971069\nfeature norm after: 1.2126387357711792\nh norm: 1.1787205934524536\ngamma range: [-0.11985763162374496, 0.16874036192893982]\nbeta range: [-0.1286344975233078, 0.12664687633514404]\nfeature norm before: 9.577706336975098\nfeature norm after: 1.2627809047698975\nh norm: 1.1787205934524536\ngamma range: [-0.12496405094861984, 0.12331799417734146]\nbeta range: [-0.1603546142578125, 0.1331469714641571]\nfeature norm before: 0.7901225686073303\nfeature norm after: 1.2143981456756592\nh norm: 1.183875560760498\ngamma range: [-0.14885234832763672, 0.13494083285331726]\nbeta range: [-0.1218537911772728, 0.11399846524000168]\nfeature norm before: 6.778860092163086\nfeature norm after: 1.1555553674697876\nh norm: 1.183875560760498\ngamma range: [-0.15862518548965454, 0.14515012502670288]\nbeta range: [-0.11805836856365204, 0.11736015975475311]\nfeature norm before: 0.7391526103019714\nfeature norm after: 1.1106288433074951\nh norm: 1.183875560760498\ngamma range: [-0.14885234832763672, 0.13494083285331726]\nbeta range: [-0.1218537911772728, 0.11399846524000168]\nfeature norm before: 6.318300247192383\nfeature norm after: 1.1532834768295288\nh norm: 1.183875560760498\ngamma range: [-0.15862518548965454, 0.14515012502670288]\nbeta range: [-0.11805836856365204, 0.11736015975475311]\nfeature norm before: 0.7429468035697937\nfeature norm after: 1.1121267080307007\nh norm: 1.183875560760498\ngamma range: [-0.13257187604904175, 0.15271976590156555]\nbeta range: [-0.10747933387756348, 0.12711527943611145]\nfeature norm before: 9.451410293579102\nfeature norm after: 1.1906993389129639\nh norm: 1.183875560760498\ngamma range: [-0.12888357043266296, 0.11447073519229889]\nbeta range: [-0.1077815443277359, 0.1475452184677124]\nfeature norm before: 0.7459449172019958\nfeature norm after: 1.1854058504104614\nh norm: 1.183875560760498\ngamma range: [-0.13257187604904175, 0.15271976590156555]\nbeta range: [-0.10747933387756348, 0.12711527943611145]\nfeature norm before: 9.357752799987793\nfeature norm after: 1.205787181854248\nh norm: 1.183875560760498\ngamma range: [-0.12888357043266296, 0.11447073519229889]\nbeta range: [-0.1077815443277359, 0.1475452184677124]\nfeature norm before: 0.717865526676178\nfeature norm after: 1.1873555183410645\nh norm: 1.183875560760498\ngamma range: [-0.17426618933677673, 0.16035869717597961]\nbeta range: [-0.11889982223510742, 0.18822981417179108]\nfeature norm before: 8.773150444030762\nfeature norm after: 1.2986916303634644\nh norm: 1.183875560760498\ngamma range: [-0.15180489420890808, 0.16506388783454895]\nbeta range: [-0.13788151741027832, 0.13967420160770416]\nfeature norm before: 0.7712352275848389\nfeature norm after: 1.1390273571014404\nh norm: 1.183875560760498\ngamma range: [-0.17426618933677673, 0.16035869717597961]\nbeta range: [-0.11889982223510742, 0.18822981417179108]\nfeature norm before: 9.893853187561035\nfeature norm after: 1.324633002281189\nh norm: 1.183875560760498\ngamma range: [-0.15180489420890808, 0.16506388783454895]\nbeta range: [-0.13788151741027832, 0.13967420160770416]\nfeature norm before: 0.7368894815444946\nfeature norm after: 1.1354703903198242\nh norm: 1.183875560760498\ngamma range: [-0.1373026967048645, 0.13396894931793213]\nbeta range: [-0.13288983702659607, 0.17361970245838165]\nfeature norm before: 10.320530891418457\nfeature norm after: 1.4210692644119263\nh norm: 1.183875560760498\ngamma range: [-0.15568695962429047, 0.16736295819282532]\nbeta range: [-0.1251586377620697, 0.1328725963830948]\nfeature norm before: 0.8885703682899475\nfeature norm after: 1.1189833879470825\nh norm: 1.183875560760498\ngamma range: [-0.1373026967048645, 0.13396894931793213]\nbeta range: [-0.13288983702659607, 0.17361970245838165]\nfeature norm before: 8.94548225402832\nfeature norm after: 1.4460434913635254\nh norm: 1.183875560760498\ngamma range: [-0.15568695962429047, 0.16736295819282532]\nbeta range: [-0.1251586377620697, 0.1328725963830948]\nfeature norm before: 0.7611435651779175\nfeature norm after: 1.1254252195358276\nh norm: 1.183875560760498\ngamma range: [-0.1522957980632782, 0.14452007412910461]\nbeta range: [-0.1264306902885437, 0.15534178912639618]\nfeature norm before: 9.535476684570312\nfeature norm after: 1.3445079326629639\nh norm: 1.183875560760498\ngamma range: [-0.1252853125333786, 0.11903401464223862]\nbeta range: [-0.16801872849464417, 0.17135202884674072]\nfeature norm before: 0.8248448967933655\nfeature norm after: 1.2524796724319458\nh norm: 1.183875560760498\ngamma range: [-0.1522957980632782, 0.14452007412910461]\nbeta range: [-0.1264306902885437, 0.15534178912639618]\nfeature norm before: 8.754589080810547\nfeature norm after: 1.328802227973938\nh norm: 1.183875560760498\ngamma range: [-0.1252853125333786, 0.11903401464223862]\nbeta range: [-0.16801872849464417, 0.17135202884674072]\nfeature norm before: 0.8544499278068542\nfeature norm after: 1.2543971538543701\nh norm: 1.183875560760498\ngamma range: [-0.14702259004116058, 0.11610380560159683]\nbeta range: [-0.14135482907295227, 0.1275818645954132]\nfeature norm before: 9.840950965881348\nfeature norm after: 1.2754631042480469\nh norm: 1.183875560760498\ngamma range: [-0.14616453647613525, 0.12426336854696274]\nbeta range: [-0.1366877257823944, 0.14175552129745483]\nfeature norm before: 0.7531346678733826\nfeature norm after: 1.1939555406570435\nh norm: 1.183875560760498\ngamma range: [-0.14702259004116058, 0.11610380560159683]\nbeta range: [-0.14135482907295227, 0.1275818645954132]\nfeature norm before: 8.84196949005127\nfeature norm after: 1.2423163652420044\nh norm: 1.183875560760498\ngamma range: [-0.14616453647613525, 0.12426336854696274]\nbeta range: [-0.1366877257823944, 0.14175552129745483]\nfeature norm before: 0.7952715754508972\nfeature norm after: 1.195581316947937\nh norm: 1.183875560760498\ngamma range: [-0.16914206743240356, 0.1427295207977295]\nbeta range: [-0.1323460340499878, 0.13671278953552246]\nfeature norm before: 9.417888641357422\nfeature norm after: 1.2542647123336792\nh norm: 1.183875560760498\ngamma range: [-0.14769794046878815, 0.1336541473865509]\nbeta range: [-0.13450887799263, 0.14286166429519653]\nfeature norm before: 0.7759463787078857\nfeature norm after: 1.2822349071502686\nh norm: 1.183875560760498\ngamma range: [-0.16914206743240356, 0.1427295207977295]\nbeta range: [-0.1323460340499878, 0.13671278953552246]\nfeature norm before: 9.008249282836914\nfeature norm after: 1.2212778329849243\nh norm: 1.183875560760498\ngamma range: [-0.14769794046878815, 0.1336541473865509]\nbeta range: [-0.13450887799263, 0.14286166429519653]\nfeature norm before: 0.7927637696266174\nfeature norm after: 1.282783031463623\nh norm: 1.183875560760498\ngamma range: [-0.14535747468471527, 0.1326426863670349]\nbeta range: [-0.13283607363700867, 0.12066091597080231]\nfeature norm before: 10.216259002685547\nfeature norm after: 1.2720897197723389\nh norm: 1.183875560760498\ngamma range: [-0.1387784779071808, 0.12773604691028595]\nbeta range: [-0.10185292363166809, 0.17060738801956177]\nfeature norm before: 0.8026617169380188\nfeature norm after: 1.1793537139892578\nh norm: 1.183875560760498\ngamma range: [-0.14535747468471527, 0.1326426863670349]\nbeta range: [-0.13283607363700867, 0.12066091597080231]\nfeature norm before: 9.140691757202148\nfeature norm after: 1.247487187385559\nh norm: 1.183875560760498\ngamma range: [-0.1387784779071808, 0.12773604691028595]\nbeta range: [-0.10185292363166809, 0.17060738801956177]\nfeature norm before: 0.8771969676017761\nfeature norm after: 1.1793526411056519\nh norm: 1.183875560760498\ngamma range: [-0.11982374638319016, 0.17162738740444183]\nbeta range: [-0.13437600433826447, 0.12640714645385742]\nfeature norm before: 8.838812828063965\nfeature norm after: 1.2659181356430054\nh norm: 1.183875560760498\ngamma range: [-0.12709705531597137, 0.12146788090467453]\nbeta range: [-0.15908183157444, 0.13341845571994781]\nfeature norm before: 0.8250245451927185\nfeature norm after: 1.2143877744674683\nh norm: 1.183875560760498\ngamma range: [-0.11982374638319016, 0.17162738740444183]\nbeta range: [-0.13437600433826447, 0.12640714645385742]\nfeature norm before: 8.5543851852417\nfeature norm after: 1.2624503374099731\nh norm: 1.183875560760498\ngamma range: [-0.12709705531597137, 0.12146788090467453]\nbeta range: [-0.15908183157444, 0.13341845571994781]\nfeature norm before: 0.7997220754623413\nfeature norm after: 1.215397596359253\n&#34;}]}, &#34;renderCollapsed&#34;: [&#34;passed&#34;], &#34;initialSort&#34;: &#34;result&#34;, &#34;title&#34;: &#34;report.html&#34;}"></div>
    <script>
      (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
const { getCollapsedCategory, setCollapsedIds } = require('./storage.js')

class DataManager {
    setManager(data) {
        const collapsedCategories = [...getCollapsedCategory(data.renderCollapsed)]
        const collapsedIds = []
        const tests = Object.values(data.tests).flat().map((test, index) => {
            const collapsed = collapsedCategories.includes(test.result.toLowerCase())
            const id = `test_${index}`
            if (collapsed) {
                collapsedIds.push(id)
            }
            return {
                ...test,
                id,
                collapsed,
            }
        })
        const dataBlob = { ...data, tests }
        this.data = { ...dataBlob }
        this.renderData = { ...dataBlob }
        setCollapsedIds(collapsedIds)
    }

    get allData() {
        return { ...this.data }
    }

    resetRender() {
        this.renderData = { ...this.data }
    }

    setRender(data) {
        this.renderData.tests = [...data]
    }

    toggleCollapsedItem(id) {
        this.renderData.tests = this.renderData.tests.map((test) =>
            test.id === id ? { ...test, collapsed: !test.collapsed } : test,
        )
    }

    set allCollapsed(collapsed) {
        this.renderData = { ...this.renderData, tests: [...this.renderData.tests.map((test) => (
            { ...test, collapsed }
        ))] }
    }

    get testSubset() {
        return [...this.renderData.tests]
    }

    get environment() {
        return this.renderData.environment
    }

    get initialSort() {
        return this.data.initialSort
    }
}

module.exports = {
    manager: new DataManager(),
}

},{"./storage.js":8}],2:[function(require,module,exports){
const mediaViewer = require('./mediaviewer.js')
const templateEnvRow = document.getElementById('template_environment_row')
const templateResult = document.getElementById('template_results-table__tbody')

function htmlToElements(html) {
    const temp = document.createElement('template')
    temp.innerHTML = html
    return temp.content.childNodes
}

const find = (selector, elem) => {
    if (!elem) {
        elem = document
    }
    return elem.querySelector(selector)
}

const findAll = (selector, elem) => {
    if (!elem) {
        elem = document
    }
    return [...elem.querySelectorAll(selector)]
}

const dom = {
    getStaticRow: (key, value) => {
        const envRow = templateEnvRow.content.cloneNode(true)
        const isObj = typeof value === 'object' && value !== null
        const values = isObj ? Object.keys(value).map((k) => `${k}: ${value[k]}`) : null

        const valuesElement = htmlToElements(
            values ? `<ul>${values.map((val) => `<li>${val}</li>`).join('')}<ul>` : `<div>${value}</div>`)[0]
        const td = findAll('td', envRow)
        td[0].textContent = key
        td[1].appendChild(valuesElement)

        return envRow
    },
    getResultTBody: ({ testId, id, log, extras, resultsTableRow, tableHtml, result, collapsed }) => {
        const resultBody = templateResult.content.cloneNode(true)
        resultBody.querySelector('tbody').classList.add(result.toLowerCase())
        resultBody.querySelector('tbody').id = testId
        resultBody.querySelector('.collapsible').dataset.id = id

        resultsTableRow.forEach((html) => {
            const t = document.createElement('template')
            t.innerHTML = html
            resultBody.querySelector('.collapsible').appendChild(t.content)
        })

        if (log) {
            // Wrap lines starting with "E" with span.error to color those lines red
            const wrappedLog = log.replace(/^E.*$/gm, (match) => `<span class="error">${match}</span>`)
            resultBody.querySelector('.log').innerHTML = wrappedLog
        } else {
            resultBody.querySelector('.log').remove()
        }

        if (collapsed) {
            resultBody.querySelector('.collapsible > td')?.classList.add('collapsed')
            resultBody.querySelector('.extras-row').classList.add('hidden')
        } else {
            resultBody.querySelector('.collapsible > td')?.classList.remove('collapsed')
        }

        const media = []
        extras?.forEach(({ name, format_type, content }) => {
            if (['image', 'video'].includes(format_type)) {
                media.push({ path: content, name, format_type })
            }

            if (format_type === 'html') {
                resultBody.querySelector('.extraHTML').insertAdjacentHTML('beforeend', `<div>${content}</div>`)
            }
        })
        mediaViewer.setup(resultBody, media)

        // Add custom html from the pytest_html_results_table_html hook
        tableHtml?.forEach((item) => {
            resultBody.querySelector('td[class="extra"]').insertAdjacentHTML('beforeend', item)
        })

        return resultBody
    },
}

module.exports = {
    dom,
    htmlToElements,
    find,
    findAll,
}

},{"./mediaviewer.js":6}],3:[function(require,module,exports){
const { manager } = require('./datamanager.js')
const { doSort } = require('./sort.js')
const storageModule = require('./storage.js')

const getFilteredSubSet = (filter) =>
    manager.allData.tests.filter(({ result }) => filter.includes(result.toLowerCase()))

const doInitFilter = () => {
    const currentFilter = storageModule.getVisible()
    const filteredSubset = getFilteredSubSet(currentFilter)
    manager.setRender(filteredSubset)
}

const doFilter = (type, show) => {
    if (show) {
        storageModule.showCategory(type)
    } else {
        storageModule.hideCategory(type)
    }

    const currentFilter = storageModule.getVisible()
    const filteredSubset = getFilteredSubSet(currentFilter)
    manager.setRender(filteredSubset)

    const sortColumn = storageModule.getSort()
    doSort(sortColumn, true)
}

module.exports = {
    doFilter,
    doInitFilter,
}

},{"./datamanager.js":1,"./sort.js":7,"./storage.js":8}],4:[function(require,module,exports){
const { redraw, bindEvents, renderStatic } = require('./main.js')
const { doInitFilter } = require('./filter.js')
const { doInitSort } = require('./sort.js')
const { manager } = require('./datamanager.js')
const data = JSON.parse(document.getElementById('data-container').dataset.jsonblob)

function init() {
    manager.setManager(data)
    doInitFilter()
    doInitSort()
    renderStatic()
    redraw()
    bindEvents()
}

init()

},{"./datamanager.js":1,"./filter.js":3,"./main.js":5,"./sort.js":7}],5:[function(require,module,exports){
const { dom, find, findAll } = require('./dom.js')
const { manager } = require('./datamanager.js')
const { doSort } = require('./sort.js')
const { doFilter } = require('./filter.js')
const {
    getVisible,
    getCollapsedIds,
    setCollapsedIds,
    getSort,
    getSortDirection,
    possibleFilters,
} = require('./storage.js')

const removeChildren = (node) => {
    while (node.firstChild) {
        node.removeChild(node.firstChild)
    }
}

const renderStatic = () => {
    const renderEnvironmentTable = () => {
        const environment = manager.environment
        const rows = Object.keys(environment).map((key) => dom.getStaticRow(key, environment[key]))
        const table = document.getElementById('environment')
        removeChildren(table)
        rows.forEach((row) => table.appendChild(row))
    }
    renderEnvironmentTable()
}

const addItemToggleListener = (elem) => {
    elem.addEventListener('click', ({ target }) => {
        const id = target.parentElement.dataset.id
        manager.toggleCollapsedItem(id)

        const collapsedIds = getCollapsedIds()
        if (collapsedIds.includes(id)) {
            const updated = collapsedIds.filter((item) => item !== id)
            setCollapsedIds(updated)
        } else {
            collapsedIds.push(id)
            setCollapsedIds(collapsedIds)
        }
        redraw()
    })
}

const renderContent = (tests) => {
    const sortAttr = getSort(manager.initialSort)
    const sortAsc = JSON.parse(getSortDirection())
    const rows = tests.map(dom.getResultTBody)
    const table = document.getElementById('results-table')
    const tableHeader = document.getElementById('results-table-head')

    const newTable = document.createElement('table')
    newTable.id = 'results-table'

    // remove all sorting classes and set the relevant
    findAll('.sortable', tableHeader).forEach((elem) => elem.classList.remove('asc', 'desc'))
    tableHeader.querySelector(`.sortable[data-column-type="${sortAttr}"]`)?.classList.add(sortAsc ? 'desc' : 'asc')
    newTable.appendChild(tableHeader)

    if (!rows.length) {
        const emptyTable = document.getElementById('template_results-table__body--empty').content.cloneNode(true)
        newTable.appendChild(emptyTable)
    } else {
        rows.forEach((row) => {
            if (!!row) {
                findAll('.collapsible td:not(.col-links', row).forEach(addItemToggleListener)
                find('.logexpander', row).addEventListener('click',
                    (evt) => evt.target.parentNode.classList.toggle('expanded'),
                )
                newTable.appendChild(row)
            }
        })
    }

    table.replaceWith(newTable)
}

const renderDerived = () => {
    const currentFilter = getVisible()
    possibleFilters.forEach((result) => {
        const input = document.querySelector(`input[data-test-result="${result}"]`)
        input.checked = currentFilter.includes(result)
    })
}

const bindEvents = () => {
    const filterColumn = (evt) => {
        const { target: element } = evt
        const { testResult } = element.dataset

        doFilter(testResult, element.checked)
        const collapsedIds = getCollapsedIds()
        const updated = manager.renderData.tests.map((test) => {
            return {
                ...test,
                collapsed: collapsedIds.includes(test.id),
            }
        })
        manager.setRender(updated)
        redraw()
    }

    const header = document.getElementById('environment-header')
    header.addEventListener('click', () => {
        const table = document.getElementById('environment')
        table.classList.toggle('hidden')
        header.classList.toggle('collapsed')
    })

    findAll('input[name="filter_checkbox"]').forEach((elem) => {
        elem.addEventListener('click', filterColumn)
    })

    findAll('.sortable').forEach((elem) => {
        elem.addEventListener('click', (evt) => {
            const { target: element } = evt
            const { columnType } = element.dataset
            doSort(columnType)
            redraw()
        })
    })

    document.getElementById('show_all_details').addEventListener('click', () => {
        manager.allCollapsed = false
        setCollapsedIds([])
        redraw()
    })
    document.getElementById('hide_all_details').addEventListener('click', () => {
        manager.allCollapsed = true
        const allIds = manager.renderData.tests.map((test) => test.id)
        setCollapsedIds(allIds)
        redraw()
    })
}

const redraw = () => {
    const { testSubset } = manager

    renderContent(testSubset)
    renderDerived()
}

module.exports = {
    redraw,
    bindEvents,
    renderStatic,
}

},{"./datamanager.js":1,"./dom.js":2,"./filter.js":3,"./sort.js":7,"./storage.js":8}],6:[function(require,module,exports){
class MediaViewer {
    constructor(assets) {
        this.assets = assets
        this.index = 0
    }

    nextActive() {
        this.index = this.index === this.assets.length - 1 ? 0 : this.index + 1
        return [this.activeFile, this.index]
    }

    prevActive() {
        this.index = this.index === 0 ? this.assets.length - 1 : this.index -1
        return [this.activeFile, this.index]
    }

    get currentIndex() {
        return this.index
    }

    get activeFile() {
        return this.assets[this.index]
    }
}


const setup = (resultBody, assets) => {
    if (!assets.length) {
        resultBody.querySelector('.media').classList.add('hidden')
        return
    }

    const mediaViewer = new MediaViewer(assets)
    const container = resultBody.querySelector('.media-container')
    const leftArrow = resultBody.querySelector('.media-container__nav--left')
    const rightArrow = resultBody.querySelector('.media-container__nav--right')
    const mediaName = resultBody.querySelector('.media__name')
    const counter = resultBody.querySelector('.media__counter')
    const imageEl = resultBody.querySelector('img')
    const sourceEl = resultBody.querySelector('source')
    const videoEl = resultBody.querySelector('video')

    const setImg = (media, index) => {
        if (media?.format_type === 'image') {
            imageEl.src = media.path

            imageEl.classList.remove('hidden')
            videoEl.classList.add('hidden')
        } else if (media?.format_type === 'video') {
            sourceEl.src = media.path

            videoEl.classList.remove('hidden')
            imageEl.classList.add('hidden')
        }

        mediaName.innerText = media?.name
        counter.innerText = `${index + 1} / ${assets.length}`
    }
    setImg(mediaViewer.activeFile, mediaViewer.currentIndex)

    const moveLeft = () => {
        const [media, index] = mediaViewer.prevActive()
        setImg(media, index)
    }
    const doRight = () => {
        const [media, index] = mediaViewer.nextActive()
        setImg(media, index)
    }
    const openImg = () => {
        window.open(mediaViewer.activeFile.path, '_blank')
    }
    if (assets.length === 1) {
        container.classList.add('media-container--fullscreen')
    } else {
        leftArrow.addEventListener('click', moveLeft)
        rightArrow.addEventListener('click', doRight)
    }
    imageEl.addEventListener('click', openImg)
}

module.exports = {
    setup,
}

},{}],7:[function(require,module,exports){
const { manager } = require('./datamanager.js')
const storageModule = require('./storage.js')

const genericSort = (list, key, ascending, customOrder) => {
    let sorted
    if (customOrder) {
        sorted = list.sort((a, b) => {
            const aValue = a.result.toLowerCase()
            const bValue = b.result.toLowerCase()

            const aIndex = customOrder.findIndex((item) => item.toLowerCase() === aValue)
            const bIndex = customOrder.findIndex((item) => item.toLowerCase() === bValue)

            // Compare the indices to determine the sort order
            return aIndex - bIndex
        })
    } else {
        sorted = list.sort((a, b) => a[key] === b[key] ? 0 : a[key] > b[key] ? 1 : -1)
    }

    if (ascending) {
        sorted.reverse()
    }
    return sorted
}

const durationSort = (list, ascending) => {
    const parseDuration = (duration) => {
        if (duration.includes(':')) {
            // If it's in the format "HH:mm:ss"
            const [hours, minutes, seconds] = duration.split(':').map(Number)
            return (hours * 3600 + minutes * 60 + seconds) * 1000
        } else {
            // If it's in the format "nnn ms"
            return parseInt(duration)
        }
    }
    const sorted = list.sort((a, b) => parseDuration(a['duration']) - parseDuration(b['duration']))
    if (ascending) {
        sorted.reverse()
    }
    return sorted
}

const doInitSort = () => {
    const type = storageModule.getSort(manager.initialSort)
    const ascending = storageModule.getSortDirection()
    const list = manager.testSubset
    const initialOrder = ['Error', 'Failed', 'Rerun', 'XFailed', 'XPassed', 'Skipped', 'Passed']

    storageModule.setSort(type)
    storageModule.setSortDirection(ascending)

    if (type?.toLowerCase() === 'original') {
        manager.setRender(list)
    } else {
        let sortedList
        switch (type) {
        case 'duration':
            sortedList = durationSort(list, ascending)
            break
        case 'result':
            sortedList = genericSort(list, type, ascending, initialOrder)
            break
        default:
            sortedList = genericSort(list, type, ascending)
            break
        }
        manager.setRender(sortedList)
    }
}

const doSort = (type, skipDirection) => {
    const newSortType = storageModule.getSort(manager.initialSort) !== type
    const currentAsc = storageModule.getSortDirection()
    let ascending
    if (skipDirection) {
        ascending = currentAsc
    } else {
        ascending = newSortType ? false : !currentAsc
    }
    storageModule.setSort(type)
    storageModule.setSortDirection(ascending)

    const list = manager.testSubset
    const sortedList = type === 'duration' ? durationSort(list, ascending) : genericSort(list, type, ascending)
    manager.setRender(sortedList)
}

module.exports = {
    doInitSort,
    doSort,
}

},{"./datamanager.js":1,"./storage.js":8}],8:[function(require,module,exports){
const possibleFilters = [
    'passed',
    'skipped',
    'failed',
    'error',
    'xfailed',
    'xpassed',
    'rerun',
]

const getVisible = () => {
    const url = new URL(window.location.href)
    const settings = new URLSearchParams(url.search).get('visible')
    const lower = (item) => {
        const lowerItem = item.toLowerCase()
        if (possibleFilters.includes(lowerItem)) {
            return lowerItem
        }
        return null
    }
    return settings === null ?
        possibleFilters :
        [...new Set(settings?.split(',').map(lower).filter((item) => item))]
}

const hideCategory = (categoryToHide) => {
    const url = new URL(window.location.href)
    const visibleParams = new URLSearchParams(url.search).get('visible')
    const currentVisible = visibleParams ? visibleParams.split(',') : [...possibleFilters]
    const settings = [...new Set(currentVisible)].filter((f) => f !== categoryToHide).join(',')

    url.searchParams.set('visible', settings)
    window.history.pushState({}, null, unescape(url.href))
}

const showCategory = (categoryToShow) => {
    if (typeof window === 'undefined') {
        return
    }
    const url = new URL(window.location.href)
    const currentVisible = new URLSearchParams(url.search).get('visible')?.split(',').filter(Boolean) ||
        [...possibleFilters]
    const settings = [...new Set([categoryToShow, ...currentVisible])]
    const noFilter = possibleFilters.length === settings.length || !settings.length

    noFilter ? url.searchParams.delete('visible') : url.searchParams.set('visible', settings.join(','))
    window.history.pushState({}, null, unescape(url.href))
}

const getSort = (initialSort) => {
    const url = new URL(window.location.href)
    let sort = new URLSearchParams(url.search).get('sort')
    if (!sort) {
        sort = initialSort || 'result'
    }
    return sort
}

const setSort = (type) => {
    const url = new URL(window.location.href)
    url.searchParams.set('sort', type)
    window.history.pushState({}, null, unescape(url.href))
}

const getCollapsedCategory = (renderCollapsed) => {
    let categories
    if (typeof window !== 'undefined') {
        const url = new URL(window.location.href)
        const collapsedItems = new URLSearchParams(url.search).get('collapsed')
        switch (true) {
        case !renderCollapsed && collapsedItems === null:
            categories = ['passed']
            break
        case collapsedItems?.length === 0 || /^["']{2}$/.test(collapsedItems):
            categories = []
            break
        case /^all$/.test(collapsedItems) || collapsedItems === null && /^all$/.test(renderCollapsed):
            categories = [...possibleFilters]
            break
        default:
            categories = collapsedItems?.split(',').map((item) => item.toLowerCase()) || renderCollapsed
            break
        }
    } else {
        categories = []
    }
    return categories
}

const getSortDirection = () => JSON.parse(sessionStorage.getItem('sortAsc')) || false
const setSortDirection = (ascending) => sessionStorage.setItem('sortAsc', ascending)

const getCollapsedIds = () => JSON.parse(sessionStorage.getItem('collapsedIds')) || []
const setCollapsedIds = (list) => sessionStorage.setItem('collapsedIds', JSON.stringify(list))

module.exports = {
    getVisible,
    hideCategory,
    showCategory,
    getCollapsedIds,
    setCollapsedIds,
    getSort,
    setSort,
    getSortDirection,
    setSortDirection,
    getCollapsedCategory,
    possibleFilters,
}

},{}]},{},[4]);
    </script>
  </footer>
</html>